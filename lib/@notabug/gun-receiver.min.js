!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ramda"),require("uuid"),require("pm2"),require("ws")):"function"==typeof define&&define.amd?define("@notabug/gun-receiver",["ramda","uuid","pm2","ws"],t):"object"==typeof exports?exports["@notabug/gun-receiver"]=t(require("ramda"),require("uuid"),require("pm2"),require("ws")):e["@notabug/gun-receiver"]=t(e.ramda,e.uuid,e.pm2,e.ws)}("undefined"!=typeof self?self:this,function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"chainInterface",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"Receiver",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"deduplicateMessages",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"allowLeech",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"relayMessages",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"cluster",{enumerable:!0,get:function(){return c.default}}),t.websocketTransport=void 0;var r=a(n(3)),o=a(n(4)),i=a(n(6)),u=a(n(7)),s=a(n(8)),c=a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}var f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(11));t.websocketTransport=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),i=(r=n(1))&&r.__esModule?r:{default:r};function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.default=function(e){return e.get=function(t){return function t(n){var r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=function(t){var u,c,a=!1,f=t.bind(r),l=function(e){return(a=!0)&&f(u=e)},p={},d={},h={},y=e.connected(function(e){var t=e.json;!t&&e.raw&&(t=JSON.parse(e.raw)),e.json=t;var r=o.prop("@",t),i=d[r],s=o.keys(o.prop("put",t));if(i&&s.push(i),s.length){o.uniq(s).forEach(function(e){if(p[e]){var n=o.path(["put",e],t);n||a||l(),n&&(h[e]=o.mergeDeepLeft(n,h[e]||{}))}});var f=c(n);f!==u&&l(f)}}),_=function(e){if(p[e])return h[e];var t=i.default.v4();return p[e]=t,d[t]=e,y.receive({...s,json:{"#":t,get:{"#":e}},skipValidation:!0}),h[e]};return c=function(e){var t=e[e.length-1];if(1===e.length)return _(t);var r=c(e.slice(0,e.length-1));if(r){var i=o.prop(t,r);return i&&i["#"]?_(i["#"]):(e===n&&l(i),i)}},y.receive({json:{leech:!0}}),c(n),function(){return e.disconnected(y)}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.identity;return new Promise(function(e){var t=c(function(n){e(n),t()})}).then(e)};return r={get:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t([].concat(u(n),[e]),r)},on:c,then:a,once:function(e){return a(e.bind(r))&&r}}}([t],arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},e.getDiff=function(t){var n=o.keys(t),r={};return n.length?Promise.all(n.map(function(n){return e.get(n,{noRelay:!0}).then(function(o){var i=e.diffNode(o,t[n]);i&&(r[n]=i)})})).then(function(){return o.keys(r).length?r:null}):Promise.resolve({})},e},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=[],n=s(c(),2),r=n[0],a=n[1],f=s(c(),2),l=f[0],p=f[1],d=JSON.stringify;return e={connections:t,connected:function(n){var r=function(e){var t,n=e.db,r=e.send,i={},u=!1,s=n.msgId;return t={send:function(e){return n.processOut({...e,to:t}).then(function(e){return e&&r(e)}).catch(function(t){u||console.error("PISTOL send err",JSON.stringify(e,null,2),e.json.put,t),u=!0})},receive:function(e){var r=e.json,o=e.raw,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["json","raw"]);return n.processIn({...i,db:n,json:{...r,"#":r["#"]||s()},from:t}).catch(function(e){return console.error("PISTOL receive err",e,o||r)})},get:function(e){return(0,o.path)(e,i)},set:function(e,t){return i=(0,o.assocPath)(e,t,i)},msgId:s}}({db:e,send:n});return t.push(r),r},disconnected:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},msgId:function(){return i.default.v4()},onIn:r,onOut:l,processIn:a,processOut:p,stringify:d,diffNode:u.diffNode}};var r,o=n(0),i=(r=n(1))&&r.__esModule?r:{default:r},u=n(5);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var u,s=e[Symbol.iterator]();!(r=(u=s.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(){var e=[];return[function(t){return e.push(t)},function(t){var n=e.slice().reverse();return function e(t){try{var r=n.pop();return t&&r?Promise.resolve(r(t)).then(e):Promise.resolve(t)}catch(e){return Promise.reject(e)}}(t)},function(t){return e=(0,o.without)([t],e)}]}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diffNode=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0));var o=JSON.stringify;t.diffNode=function(e,t){var n=((arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||(new Date).getTime())+6e5,i=r.path(["_",">"],e)||{},u=r.path(["_",">"],t)||{};return r.compose(function(e){var n=r.keys(e);return n.length?r.assoc("_",r.assoc(">",r.pick(n,u),t._),e):null},r.reduce(function(s,c){var a=i[c],f=u[c];if(f>n||!f)return s;if(a&&a>=f)return s;if(a===f){var l=r.prop(c,e),p=r.prop(c,t);if(o(p)<=o(l))return t}return s[c]=t[c],s},{}),r.keys)(u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(0),o=5e4;t.default=function(e){var t={};return e.onIn(function(e){var n=(0,r.path)(["json","#"],e);return!n||t[n]?null:(t[n]=!0,e)}),setInterval(function(){for(var e=(0,r.keys)(t).reverse();e.length>o;)delete t[e.pop()]},6e4),e},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(0);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.default=function(e){return e.onIn(function(e){return e.from&&e.from.set?(0,r.path)(["json","leech"],e)?void e.from.set(["isLeeching"],!0):([(0,r.path)(["json","get","#"],e)].concat(o((0,r.keys)((0,r.path)(["json","put"],e)))).forEach(function(t){return t&&e.from.set(["hasAskedFor",t],!0)}),e):e}),e.onOut(function(e){var t=e.to,n=e.json,o=e.ignoreLeeching;return!t.get(["isLeeching"])||o?e:(0,r.keys)(n.put).filter(function(e){if(!t.get(["hasAskedFor",e]))return!1;var o=(0,r.path)([e,"_",">"],n.put),i=!1;return!(0,r.keys)(o).length||((0,r.keys)(o).forEach(function(n){var r=t.get(["knownDeltas",e,n])||0,u=parseFloat(o[n])||0;r&&u<=r||(t.set(["knownDeltas",e,n],u),i=!0)}),i)}).length?e:void 0}),e},e.exports=t.default},function(e,t,n){"use strict";var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0));e.exports=function(e){return e.onIn(function(t){var n=t.from;return t.noRelay?t:(r.without([n],e.connections).forEach(function(e){return e.send(r.assoc("skipValidation",!0,t))}),t)}),e}},function(e,t,n){"use strict";var r,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),i=(r=n(1))&&r.__esModule?r:{default:r};e.exports=function(e){var t=n(10),r=i.default.v4();return t.launchBus(function(t,n){t&&console.err(t),n.on("process:msg",function(t){t.raw.msg.fromCluster!==r&&"gun:msg"===t.raw.topic&&e.processIn(o.assoc("db",e,t.raw.msg)).catch(function(e){return console.error("PISTOL cluster err",e)})})}),e.onIn(function(e){var t=e.fromCluster;return e.noRelay||t?e:(process.send&&process.send({topic:"gun:msg",msg:o.mergeLeft({fromCluster:r,skipValidation:!0},e)}),e)}),e}},function(e,t){e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.client=t.server=void 0;var r=n(0),o=u(n(12)),i=u(n(13));function u(e){return e&&e.__esModule?e:{default:e}}var s=(0,r.curry)(function(e,t){var n=!1,r=!0,o=e.connected(function(o){if(o&&(o.json||o.raw)&&r){var i=o.raw||e.stringify(o.json);t.send(i,function(e){e&&!n&&(console.warn("ws send err",e),n=!0)})}}),i=setInterval(function(){return o.send({json:[],skipValidation:!0})},6e4);return t.addEventListener("close",function(){t.reconnect||(r=!1,clearInterval(i),e.disconnected(o))}),t.addEventListener("message",function e(t){try{var n=t.data||t,r="string"==typeof n?JSON.parse(n):n;Array.isArray(r)?r.forEach(e):o.receive({json:r,raw:n})}catch(e){console.error("RECEIVER invalid ws msg",e,t.data||t)}}),o}),c=(0,r.curry)(function(e,t){var n=e.web,r=e.port;return new o.default.Server({port:n?void 0:r,server:n}).on("connection",s(t)),t});t.server=c;var a=(0,r.curry)(function(e,t){var n=new i.default(e,[],{WebSocket:o.default});return n.addEventListener("open",function(){return s(t,n)}),t});t.client=a},function(e,t){e.exports=r},function(e,t,n){"use strict";n.r(t);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return function(e,t){this.target=t,this.type=e}}(),u=function(e){function t(t,n){var r=e.call(this,"error",n)||this;return r.message=t.message,r.error=t,r}return o(t,e),t}(i),s=function(e){function t(t,n,r){void 0===t&&(t=1e3),void 0===n&&(n="");var o=e.call(this,"close",r)||this;return o.wasClean=!0,o.code=t,o.reason=n,o}return o(t,e),t}(i),c=function(){if("undefined"!=typeof WebSocket)return WebSocket},a={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,debug:!1},f=function(){function e(e,t,n){void 0===n&&(n={});var r=this;this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=void 0,this.onerror=void 0,this.onmessage=void 0,this.onopen=void 0,this._handleOpen=function(e){r._debug("open event");var t=r._options.minUptime,n=void 0===t?a.minUptime:t;clearTimeout(r._connectTimeout),r._uptimeTimeout=setTimeout(function(){return r._acceptOpen()},n),r._ws.binaryType=r._binaryType,r._messageQueue.forEach(function(e){return r._ws.send(e)}),r._messageQueue=[],r.onopen&&r.onopen(e),r._listeners.open.forEach(function(t){return r._callEventListener(e,t)})},this._handleMessage=function(e){r._debug("message event"),r.onmessage&&r.onmessage(e),r._listeners.message.forEach(function(t){return r._callEventListener(e,t)})},this._handleError=function(e){r._debug("error event",e.message),r._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),r.onerror&&r.onerror(e),r._debug("exec error listeners"),r._listeners.error.forEach(function(t){return r._callEventListener(e,t)}),r._connect()},this._handleClose=function(e){r._debug("close event"),r._clearTimeouts(),r._shouldReconnect&&r._connect(),r.onclose&&r.onclose(e),r._listeners.close.forEach(function(t){return r._callEventListener(e,t)})},this._url=e,this._protocols=t,this._options=n,this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce(function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e},0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){this._ws&&this._ws.readyState===this.OPEN?(this._debug("send",e),this._ws.send(e)):(this._debug("enqueue",e),this._messageQueue.push(e))},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(e){return e!==t}))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,["RWS>"].concat(e))},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?a.reconnectionDelayGrowFactor:t,r=e.minReconnectionDelay,o=void 0===r?a.minReconnectionDelay:r,i=e.maxReconnectionDelay,u=void 0===i?a.maxReconnectionDelay:i,s=o;return this._retryCount>0&&(s=o*Math.pow(n,this._retryCount-1))>u&&(s=u),this._debug("next delay",s),s},e.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,r=void 0===n?a.maxRetries:n,o=t.connectionTimeout,i=void 0===o?a.connectionTimeout:o,u=t.WebSocket,s=void 0===u?c():u;if(this._retryCount>=r)this._debug("max retries reached",this._retryCount,">=",r);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),"function"!=typeof(f=s)||2!==f.CLOSING)throw Error("No valid WebSocket class provided");var f;this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(t){e._closeCalled?e._connectLock=!1:(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new s(t,e._protocols):new s(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},i))})}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new u(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new s(e,t,this))}catch(e){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();t.default=f}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Abm90YWJ1Zy9ndW4tcmVjZWl2ZXIvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Abm90YWJ1Zy9ndW4tcmVjZWl2ZXIvZXh0ZXJuYWwgXCJyYW1kYVwiIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci9leHRlcm5hbCBcInV1aWRcIiIsIndlYnBhY2s6Ly9Abm90YWJ1Zy9ndW4tcmVjZWl2ZXIvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQG5vdGFidWcvZ3VuLXJlY2VpdmVyLy4vc3JjL2NoYWluLmpzIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci8uL3NyYy9jb3JlLmpzIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci8uL3NyYy9kaWZmLmpzIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci8uL3NyYy9kZWR1cC5qcyIsIndlYnBhY2s6Ly9Abm90YWJ1Zy9ndW4tcmVjZWl2ZXIvLi9zcmMvbGVlY2guanMiLCJ3ZWJwYWNrOi8vQG5vdGFidWcvZ3VuLXJlY2VpdmVyLy4vc3JjL3JlbGF5LmpzIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci8uL3NyYy9jbHVzdGVyLmpzIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci9leHRlcm5hbCBcInBtMlwiIiwid2VicGFjazovL0Bub3RhYnVnL2d1bi1yZWNlaXZlci8uL3NyYy93ZWJzb2NrZXQuanMiLCJ3ZWJwYWNrOi8vQG5vdGFidWcvZ3VuLXJlY2VpdmVyL2V4dGVybmFsIFwid3NcIiIsIndlYnBhY2s6Ly9Abm90YWJ1Zy9ndW4tcmVjZWl2ZXIvLi9ub2RlX21vZHVsZXMvcmVjb25uZWN0aW5nLXdlYnNvY2tldC9kaXN0L3JlY29ubmVjdGluZy13ZWJzb2NrZXQubWpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsInJlcXVpcmUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwidGhpcyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzFfXyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzEwX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xMl9fIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIl9jaGFpbiIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfY29yZSIsIl9kZWR1cCIsIl9sZWVjaCIsIl9yZWxheSIsIl9jbHVzdGVyIiwid2Vic29ja2V0VHJhbnNwb3J0IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJSIiwiX3V1aWQiLCJkYiIsImdldFBhdGgiLCJrZXlMaXN0IiwidGhpc0NoYWluIiwib3B0cyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIm9uIiwiZm4iLCJnZXRWYWx1ZSIsImhhc1Jlc3BvbnNlIiwiYm91bmQiLCJyZWNlaXZlZCIsInZhbCIsInJlcXVlc3RlZCIsInJlcXVlc3RzIiwiZ3JhcGgiLCJjb25uZWN0aW9uIiwiY29ubmVjdGVkIiwibXNnIiwianNvbiIsInJhdyIsIkpTT04iLCJwYXJzZSIsImF0IiwicHJvcCIsImF0U291bCIsInNvdWxzIiwia2V5cyIsInB1c2giLCJ1bmlxIiwiZm9yRWFjaCIsInNvdWwiLCJub2RlIiwicGF0aCIsIm1lcmdlRGVlcExlZnQiLCJuZXh0VmFsdWUiLCJnZXROb2RlIiwiaWQiLCJkZWZhdWx0IiwidjQiLCJyZWNlaXZlIiwiIyIsInNraXBWYWxpZGF0aW9uIiwia2wiLCJsYXN0S2V5IiwicGFyZW50VmFsdWUiLCJzbGljZSIsImxlZWNoIiwiZGlzY29ubmVjdGVkIiwidGhlbiIsImlkZW50aXR5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJ1bnN1YnNjcmliZSIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheSIsIm9uY2UiLCJnZXREaWZmIiwicHV0IiwiZGlmZnMiLCJhbGwiLCJtYXAiLCJub1JlbGF5IiwiZXhpc3RpbmciLCJkaWZmIiwiZGlmZk5vZGUiLCJwZWVyIiwiY29ubmVjdGlvbnMiLCJfcHJvY2Vzc1F1ZXVlMiIsIl9zbGljZWRUb0FycmF5IiwicHJvY2Vzc1F1ZXVlIiwib25JbiIsInByb2Nlc3NJbiIsIl9wcm9jZXNzUXVldWU0Iiwib25PdXQiLCJwcm9jZXNzT3V0Iiwic3RyaW5naWZ5Iiwic2VuZCIsIl9yZWYiLCJzZW5kRm4iLCJzdGF0ZSIsImhhc1JlcG9ydGVkRXJyb3IiLCJtc2dJZCIsInRvIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJfcmVmMiIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllcyIsImZyb20iLCJfcmFtZGEiLCJzZXQiLCJ2IiwiYXNzb2NQYXRoIiwicGlzdG9sQ29ubmVjdGlvbiIsImNvbm5lY3Rpb25JZHgiLCJpbmRleE9mIiwic3BsaWNlIiwiX2RpZmYiLCJmbnMiLCJyZW1haW5pbmdGbnMiLCJyZXZlcnNlIiwiZXhlY3V0ZU5leHQiLCJwb3AiLCJlIiwicmVqZWN0Iiwid2l0aG91dCIsIkxleGljYWwiLCJ1cGRhdGVkIiwibWF4U3RhdGUiLCJEYXRlIiwiZ2V0VGltZSIsImV4aXN0aW5nU3RhdGUiLCJ1cGRhdGVkU3RhdGUiLCJjb21wb3NlIiwidmFscyIsImFzc29jIiwicGljayIsIl8iLCJyZWR1Y2UiLCJ1cGRhdGVzIiwiZXhpc3RpbmdLZXlTdGF0ZSIsInVwZGF0ZWRLZXlTdGF0ZSIsImV4aXN0aW5nVmFsIiwidXBkYXRlZFZhbCIsIk1BWF9NU0dfSURfQ0FDSEUiLCJyZWNlaXZlZElkcyIsInNldEludGVydmFsIiwiaWRzIiwiaWdub3JlTGVlY2hpbmciLCJmaWx0ZXIiLCJzb3VsRGVsdGFzIiwiaGFzVXBkYXRlcyIsImtub3duIiwiZGVsdGEiLCJwYXJzZUZsb2F0IiwicG0yIiwibGF1bmNoQnVzIiwiYnVzIiwicGFja2V0IiwiZnJvbUNsdXN0ZXIiLCJ0b3BpYyIsInByb2Nlc3MiLCJtZXJnZUxlZnQiLCJfd3MiLCJfcmVjb25uZWN0aW5nV2Vic29ja2V0Iiwid3NDb25uZWN0aW9uIiwiY3VycnkiLCJ3cyIsImhhc0xvZ2dlZEVyciIsIndhcm4iLCJwaW5nSW50ZXJ2YWwiLCJhZGRFdmVudExpc3RlbmVyIiwicmVjb25uZWN0IiwiY2xlYXJJbnRlcnZhbCIsImRhdGEiLCJBcnJheSIsImlzQXJyYXkiLCJzZXJ2ZXIiLCJ3ZWIiLCJwb3J0IiwiU2VydmVyIiwiY2xpZW50IiwidXJsIiwiV2ViU29ja2V0IiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsImV4dGVuZFN0YXRpY3MiLCJiIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJfX2V4dGVuZHMiLCJfXyIsImNvbnN0cnVjdG9yIiwiRXZlbnQiLCJ0eXBlIiwidGFyZ2V0IiwiRXJyb3JFdmVudCIsIl9zdXBlciIsIl90aGlzIiwibWVzc2FnZSIsIkNsb3NlRXZlbnQiLCJjb2RlIiwicmVhc29uIiwid2FzQ2xlYW4iLCJnZXRHbG9iYWxXZWJTb2NrZXQiLCJERUZBVUxUIiwibWF4UmVjb25uZWN0aW9uRGVsYXkiLCJtaW5SZWNvbm5lY3Rpb25EZWxheSIsIk1hdGgiLCJyYW5kb20iLCJtaW5VcHRpbWUiLCJyZWNvbm5lY3Rpb25EZWxheUdyb3dGYWN0b3IiLCJjb25uZWN0aW9uVGltZW91dCIsIm1heFJldHJpZXMiLCJJbmZpbml0eSIsImRlYnVnIiwiUmVjb25uZWN0aW5nV2ViU29ja2V0IiwicHJvdG9jb2xzIiwib3B0aW9ucyIsIl9saXN0ZW5lcnMiLCJvcGVuIiwiY2xvc2UiLCJfcmV0cnlDb3VudCIsIl9zaG91bGRSZWNvbm5lY3QiLCJfY29ubmVjdExvY2siLCJfYmluYXJ5VHlwZSIsIl9jbG9zZUNhbGxlZCIsIl9tZXNzYWdlUXVldWUiLCJvbmNsb3NlIiwib25lcnJvciIsIm9ubWVzc2FnZSIsIm9ub3BlbiIsIl9oYW5kbGVPcGVuIiwiZXZlbnQiLCJfZGVidWciLCJfYSIsIl9vcHRpb25zIiwiY2xlYXJUaW1lb3V0IiwiX2Nvbm5lY3RUaW1lb3V0IiwiX3VwdGltZVRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiX2FjY2VwdE9wZW4iLCJiaW5hcnlUeXBlIiwibGlzdGVuZXIiLCJfY2FsbEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTWVzc2FnZSIsIl9oYW5kbGVFcnJvciIsIl9kaXNjb25uZWN0IiwiX2Nvbm5lY3QiLCJfaGFuZGxlQ2xvc2UiLCJfY2xlYXJUaW1lb3V0cyIsIl91cmwiLCJfcHJvdG9jb2xzIiwiY29uZmlndXJhYmxlIiwiQ09OTkVDVElORyIsIk9QRU4iLCJDTE9TSU5HIiwiQ0xPU0VEIiwibWF4IiwiYWNjIiwiQmxvYiIsInNpemUiLCJieXRlTGVuZ3RoIiwiYnVmZmVyZWRBbW91bnQiLCJleHRlbnNpb25zIiwicHJvdG9jb2wiLCJyZWFkeVN0YXRlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFyZ3MiLCJfaSIsImxvZyIsImFwcGx5IiwiX2dldE5leHREZWxheSIsIl9iIiwiX2MiLCJfZCIsImRlbGF5IiwicG93IiwiX3dhaXQiLCJfZ2V0TmV4dFVybCIsInVybFByb3ZpZGVyIiwiRXJyb3IiLCJfcmVtb3ZlTGlzdGVuZXJzIiwidyIsIl9hZGRMaXN0ZW5lcnMiLCJfaGFuZGxlVGltZW91dCIsImhhbmRsZUV2ZW50Il0sIm1hcHBpbmdz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LEtBQUFzTSxJQUFBdUcsb0JBQUEsUUFBQTdTLEtBQUEyUixjQUNBM1IsS0FBQXNNLElBQUF1RyxvQkFBQSxVQUFBN1MsS0FBQXVSLGdCQUVBdlIsS0FBQXNNLElBQUF1RyxvQkFBQSxRQUFBN1MsS0FBQXdSLGdCQUVBOUIsRUFBQXROLFVBQUEwUixjQUFBLFdBQ0E5VCxLQUFBc00sTUFHQXRNLEtBQUE0USxPQUFBLGdCQUNBNVEsS0FBQXNNLElBQUFRLGlCQUFBLE9BQUE5TSxLQUFBMFEsYUFDQTFRLEtBQUFzTSxJQUFBUSxpQkFBQSxRQUFBOU0sS0FBQTJSLGNBQ0EzUixLQUFBc00sSUFBQVEsaUJBQUEsVUFBQTlNLEtBQUF1UixnQkFFQXZSLEtBQUFzTSxJQUFBUSxpQkFBQSxRQUFBOU0sS0FBQXdSLGdCQUVBOUIsRUFBQXROLFVBQUF3UCxlQUFBLFdBQ0FiLGFBQUEvUSxLQUFBZ1IsaUJBQ0FELGFBQUEvUSxLQUFBaVIsaUJBRUF2QixFQW5iQSxHQXNiZS9CLEVBQUEiLCJmaWxlIjoiQG5vdGFidWcvZ3VuLXJlY2VpdmVyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcInJhbWRhXCIpLCByZXF1aXJlKFwidXVpZFwiKSwgcmVxdWlyZShcInBtMlwiKSwgcmVxdWlyZShcIndzXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiQG5vdGFidWcvZ3VuLXJlY2VpdmVyXCIsIFtcInJhbWRhXCIsIFwidXVpZFwiLCBcInBtMlwiLCBcIndzXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIkBub3RhYnVnL2d1bi1yZWNlaXZlclwiXSA9IGZhY3RvcnkocmVxdWlyZShcInJhbWRhXCIpLCByZXF1aXJlKFwidXVpZFwiKSwgcmVxdWlyZShcInBtMlwiKSwgcmVxdWlyZShcIndzXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJAbm90YWJ1Zy9ndW4tcmVjZWl2ZXJcIl0gPSBmYWN0b3J5KHJvb3RbXCJyYW1kYVwiXSwgcm9vdFtcInV1aWRcIl0sIHJvb3RbXCJwbTJcIl0sIHJvb3RbXCJ3c1wiXSk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzEwX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzEyX18pIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMik7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXzsiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzFfXzsiLCJleHBvcnQgeyBkZWZhdWx0IGFzIGNoYWluSW50ZXJmYWNlIH0gZnJvbSBcIi4vY2hhaW5cIjtcbmV4cG9ydCB7IGRlZmF1bHQgYXMgUmVjZWl2ZXIgfSBmcm9tIFwiLi9jb3JlXCI7XG5leHBvcnQgeyBkZWZhdWx0IGFzIGRlZHVwbGljYXRlTWVzc2FnZXMgfSBmcm9tIFwiLi9kZWR1cFwiO1xuZXhwb3J0IHsgZGVmYXVsdCBhcyBhbGxvd0xlZWNoIH0gZnJvbSBcIi4vbGVlY2hcIjtcbmV4cG9ydCB7IGRlZmF1bHQgYXMgcmVsYXlNZXNzYWdlcyB9IGZyb20gXCIuL3JlbGF5XCI7XG5leHBvcnQgeyBkZWZhdWx0IGFzIGNsdXN0ZXIgfSBmcm9tIFwiLi9jbHVzdGVyXCI7XG5pbXBvcnQgKiBhcyB3ZWJzb2NrZXQgZnJvbSBcIi4vd2Vic29ja2V0XCI7XG5cbmV4cG9ydCBjb25zdCB3ZWJzb2NrZXRUcmFuc3BvcnQgPSB3ZWJzb2NrZXQ7XG4iLCIvKiBnbG9iYWxzIFByb21pc2UgKi9cbmltcG9ydCAqIGFzIFIgZnJvbSBcInJhbWRhXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwidXVpZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBkYiA9PiB7XG4gIGNvbnN0IGdldFBhdGggPSAoa2V5TGlzdCwgb3B0cyA9IHt9KSA9PiB7XG4gICAgbGV0IHRoaXNDaGFpbjtcbiAgICBjb25zdCBvbiA9IGZuID0+IHtcbiAgICAgIGxldCB2YWx1ZSwgZ2V0VmFsdWU7XG4gICAgICBsZXQgaGFzUmVzcG9uc2UgPSBmYWxzZTtcbiAgICAgIGNvbnN0IGJvdW5kID0gZm4uYmluZCh0aGlzQ2hhaW4pO1xuICAgICAgY29uc3QgcmVjZWl2ZWQgPSB2YWwgPT4gKGhhc1Jlc3BvbnNlID0gdHJ1ZSkgJiYgYm91bmQoKHZhbHVlID0gdmFsKSk7XG4gICAgICBjb25zdCByZXF1ZXN0ZWQgPSB7fTtcbiAgICAgIGNvbnN0IHJlcXVlc3RzID0ge307XG4gICAgICBjb25zdCBncmFwaCA9IHt9O1xuXG4gICAgICBjb25zdCBjb25uZWN0aW9uID0gZGIuY29ubmVjdGVkKG1zZyA9PiB7XG4gICAgICAgIGxldCB7IGpzb24gfSA9IG1zZztcblxuICAgICAgICBpZiAoIWpzb24gJiYgbXNnLnJhdykganNvbiA9IEpTT04ucGFyc2UobXNnLnJhdyk7XG4gICAgICAgIG1zZy5qc29uID0ganNvbjtcbiAgICAgICAgY29uc3QgYXQgPSBSLnByb3AoXCJAXCIsIGpzb24pO1xuICAgICAgICBjb25zdCBhdFNvdWwgPSByZXF1ZXN0c1thdF07XG4gICAgICAgIGNvbnN0IHNvdWxzID0gUi5rZXlzKFIucHJvcChcInB1dFwiLCBqc29uKSk7XG5cbiAgICAgICAgaWYgKGF0U291bCkgc291bHMucHVzaChhdFNvdWwpO1xuICAgICAgICBpZiAoIXNvdWxzLmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICBSLnVuaXEoc291bHMpLmZvckVhY2goc291bCA9PiB7XG4gICAgICAgICAgaWYgKCFyZXF1ZXN0ZWRbc291bF0pIHJldHVybjtcbiAgICAgICAgICBjb25zdCBub2RlID0gUi5wYXRoKFtcInB1dFwiLCBzb3VsXSwganNvbik7XG5cbiAgICAgICAgICBpZiAoIW5vZGUgJiYgIWhhc1Jlc3BvbnNlKSByZWNlaXZlZCgpO1xuICAgICAgICAgIGlmIChub2RlKSBncmFwaFtzb3VsXSA9IFIubWVyZ2VEZWVwTGVmdChub2RlLCBncmFwaFtzb3VsXSB8fCB7fSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBuZXh0VmFsdWUgPSBnZXRWYWx1ZShrZXlMaXN0KTtcblxuICAgICAgICBpZiAobmV4dFZhbHVlICE9PSB2YWx1ZSkgcmVjZWl2ZWQobmV4dFZhbHVlKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBnZXROb2RlID0gc291bCA9PiB7XG4gICAgICAgIGlmIChyZXF1ZXN0ZWRbc291bF0pIHJldHVybiBncmFwaFtzb3VsXTtcbiAgICAgICAgY29uc3QgaWQgPSB1dWlkLnY0KCk7XG5cbiAgICAgICAgcmVxdWVzdGVkW3NvdWxdID0gaWQ7XG4gICAgICAgIHJlcXVlc3RzW2lkXSA9IHNvdWw7XG4gICAgICAgIGNvbm5lY3Rpb24ucmVjZWl2ZSh7XG4gICAgICAgICAgLi4ub3B0cyxcbiAgICAgICAgICBqc29uOiB7IFwiI1wiOiBpZCwgZ2V0OiB7IFwiI1wiOiBzb3VsIH0gfSxcbiAgICAgICAgICBza2lwVmFsaWRhdGlvbjogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGdyYXBoW3NvdWxdO1xuICAgICAgfTtcblxuICAgICAgZ2V0VmFsdWUgPSBrbCA9PiB7XG4gICAgICAgIGNvbnN0IGxhc3RLZXkgPSBrbFtrbC5sZW5ndGggLSAxXTtcblxuICAgICAgICBpZiAoa2wubGVuZ3RoID09PSAxKSByZXR1cm4gZ2V0Tm9kZShsYXN0S2V5KTtcbiAgICAgICAgY29uc3QgcGFyZW50VmFsdWUgPSBnZXRWYWx1ZShrbC5zbGljZSgwLCBrbC5sZW5ndGggLSAxKSk7XG5cbiAgICAgICAgaWYgKCFwYXJlbnRWYWx1ZSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBSLnByb3AobGFzdEtleSwgcGFyZW50VmFsdWUpO1xuXG4gICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZVtcIiNcIl0pIHJldHVybiBnZXROb2RlKHZhbHVlW1wiI1wiXSk7XG4gICAgICAgIGlmIChrbCA9PT0ga2V5TGlzdCkgcmVjZWl2ZWQodmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9O1xuXG4gICAgICBjb25uZWN0aW9uLnJlY2VpdmUoeyBqc29uOiB7IGxlZWNoOiB0cnVlIH0gfSk7XG4gICAgICBnZXRWYWx1ZShrZXlMaXN0KTtcbiAgICAgIHJldHVybiAoKSA9PiBkYi5kaXNjb25uZWN0ZWQoY29ubmVjdGlvbik7XG4gICAgfTtcblxuICAgIGNvbnN0IHRoZW4gPSAoZm4gPSBSLmlkZW50aXR5KSA9PlxuICAgICAgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gb24odmFsID0+IHtcbiAgICAgICAgICByZXNvbHZlKHZhbCk7XG4gICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KS50aGVuKGZuKTtcblxuICAgIGNvbnN0IG9uY2UgPSBmbiA9PiB0aGVuKGZuLmJpbmQodGhpc0NoYWluKSkgJiYgdGhpc0NoYWluO1xuICAgIGNvbnN0IGdldCA9IChrZXksIG9wdHMgPSB7fSkgPT4gZ2V0UGF0aChbLi4ua2V5TGlzdCwga2V5XSwgb3B0cyk7XG5cbiAgICB0aGlzQ2hhaW4gPSB7IGdldCwgb24sIHRoZW4sIG9uY2UgfTtcbiAgICByZXR1cm4gdGhpc0NoYWluO1xuICB9O1xuXG4gIGNvbnN0IGdldERpZmYgPSBwdXQgPT4ge1xuICAgIGNvbnN0IHNvdWxzID0gUi5rZXlzKHB1dCk7XG4gICAgY29uc3QgZGlmZnMgPSB7fTtcblxuICAgIGlmICghc291bHMubGVuZ3RoKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHt9KTtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoXG4gICAgICBzb3Vscy5tYXAoc291bCA9PlxuICAgICAgICBkYi5nZXQoc291bCwgeyBub1JlbGF5OiB0cnVlIH0pLnRoZW4oZXhpc3RpbmcgPT4ge1xuICAgICAgICAgIGNvbnN0IGRpZmYgPSBkYi5kaWZmTm9kZShleGlzdGluZywgcHV0W3NvdWxdKTtcblxuICAgICAgICAgIGlmIChkaWZmKSBkaWZmc1tzb3VsXSA9IGRpZmY7XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgKS50aGVuKCgpID0+IHtcbiAgICAgIGlmICghUi5rZXlzKGRpZmZzKS5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgcmV0dXJuIGRpZmZzO1xuICAgIH0pO1xuICB9O1xuXG4gIGRiLmdldCA9IChrZXksIG9wdHMgPSB7fSkgPT4gZ2V0UGF0aChba2V5XSwgb3B0cyk7XG4gIGRiLmdldERpZmYgPSBnZXREaWZmO1xuICByZXR1cm4gZGI7XG59O1xuIiwiLyogZ2xvYmFscyBQcm9taXNlICovXG5pbXBvcnQgeyBhc3NvY1BhdGgsIHBhdGgsIHdpdGhvdXQgfSBmcm9tIFwicmFtZGFcIjtcbmltcG9ydCB1dWlkIGZyb20gXCJ1dWlkXCI7XG5pbXBvcnQgeyBkaWZmTm9kZSB9IGZyb20gXCIuL2RpZmZcIjtcblxuZnVuY3Rpb24gcHJvY2Vzc1F1ZXVlKCkge1xuICBsZXQgZm5zID0gW107XG4gIGNvbnN0IHF1ZXVlID0gZm4gPT4gZm5zLnB1c2goZm4pO1xuICBjb25zdCBkZXF1ZXVlID0gZm4gPT4gKGZucyA9IHdpdGhvdXQoW2ZuXSwgZm5zKSk7XG5cbiAgZnVuY3Rpb24gZXhlY3V0ZShtc2cpIHtcbiAgICBjb25zdCByZW1haW5pbmdGbnMgPSBmbnMuc2xpY2UoKS5yZXZlcnNlKCk7XG4gICAgY29uc3QgZXhlY3V0ZU5leHQgPSBtc2cgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZm4gPSByZW1haW5pbmdGbnMucG9wKCk7XG5cbiAgICAgICAgaWYgKG1zZyAmJiBmbikgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmbihtc2cpKS50aGVuKGV4ZWN1dGVOZXh0KTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtc2cpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBleGVjdXRlTmV4dChtc2cpO1xuICB9XG5cbiAgcmV0dXJuIFtxdWV1ZSwgZXhlY3V0ZSwgZGVxdWV1ZV07XG59XG5cbmZ1bmN0aW9uIHBpc3RvbENvbm5lY3Rpb24oeyBkYiwgc2VuZDogc2VuZEZuIH0pIHtcbiAgbGV0IGNvbm5lY3Rpb247XG4gIGxldCBzdGF0ZSA9IHt9O1xuICBsZXQgaGFzUmVwb3J0ZWRFcnJvciA9IGZhbHNlO1xuICBjb25zdCBnZXQgPSBwID0+IHBhdGgocCwgc3RhdGUpO1xuICBjb25zdCBzZXQgPSAocCwgdikgPT4gKHN0YXRlID0gYXNzb2NQYXRoKHAsIHYsIHN0YXRlKSk7IC8vICYmIGNvbnNvbGUubG9nKHN0YXRlKTtcbiAgY29uc3QgeyBtc2dJZCB9ID0gZGI7XG4gIGNvbnN0IHNlbmQgPSBtc2cgPT5cbiAgICBkYlxuICAgICAgLnByb2Nlc3NPdXQoeyAuLi5tc2csIHRvOiBjb25uZWN0aW9uIH0pXG4gICAgICAudGhlbihyID0+IHIgJiYgc2VuZEZuKHIpKVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGlmICghaGFzUmVwb3J0ZWRFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgICBcIlBJU1RPTCBzZW5kIGVyclwiLFxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkobXNnLCBudWxsLCAyKSxcbiAgICAgICAgICAgIG1zZy5qc29uLnB1dCxcbiAgICAgICAgICAgIGVyclxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaGFzUmVwb3J0ZWRFcnJvciA9IHRydWU7XG4gICAgICB9KTtcbiAgY29uc3QgcmVjZWl2ZSA9ICh7IGpzb24sIHJhdywgLi4ub3B0cyB9KSA9PiB7XG4gICAgcmV0dXJuIGRiXG4gICAgICAucHJvY2Vzc0luKHtcbiAgICAgICAgLi4ub3B0cyxcbiAgICAgICAgZGIsXG4gICAgICAgIGpzb246IHsgLi4uanNvbiwgXCIjXCI6IGpzb25bXCIjXCJdIHx8IG1zZ0lkKCkgfSxcbiAgICAgICAgZnJvbTogY29ubmVjdGlvblxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihcIlBJU1RPTCByZWNlaXZlIGVyclwiLCBlcnIsIHJhdyB8fCBqc29uKSk7XG4gIH07XG5cbiAgY29ubmVjdGlvbiA9IHsgc2VuZCwgcmVjZWl2ZSwgZ2V0LCBzZXQsIG1zZ0lkIH07XG4gIHJldHVybiBjb25uZWN0aW9uO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBSZWNlaXZlcigpIHtcbiAgbGV0IHBlZXI7XG4gIGNvbnN0IGNvbm5lY3Rpb25zID0gW107XG4gIGNvbnN0IFtvbkluLCBwcm9jZXNzSW5dID0gcHJvY2Vzc1F1ZXVlKCk7XG4gIGNvbnN0IFtvbk91dCwgcHJvY2Vzc091dF0gPSBwcm9jZXNzUXVldWUoKTtcbiAgY29uc3QgbXNnSWQgPSAoKSA9PiB1dWlkLnY0KCk7XG4gIGNvbnN0IHN0cmluZ2lmeSA9IEpTT04uc3RyaW5naWZ5O1xuXG4gIGZ1bmN0aW9uIGNvbm5lY3RlZChzZW5kKSB7XG4gICAgY29uc3QgY29ubmVjdGlvbiA9IHBpc3RvbENvbm5lY3Rpb24oeyBkYjogcGVlciwgc2VuZCB9KTtcblxuICAgIGNvbm5lY3Rpb25zLnB1c2goY29ubmVjdGlvbik7XG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gIH1cblxuICBmdW5jdGlvbiBkaXNjb25uZWN0ZWQoY29ubmVjdGlvbikge1xuICAgIGNvbnN0IGNvbm5lY3Rpb25JZHggPSBjb25uZWN0aW9ucy5pbmRleE9mKGNvbm5lY3Rpb24pO1xuXG4gICAgaWYgKGNvbm5lY3Rpb25JZHggIT09IC0xKSBjb25uZWN0aW9ucy5zcGxpY2UoY29ubmVjdGlvbklkeCwgMSk7XG4gIH1cblxuICBwZWVyID0ge1xuICAgIGNvbm5lY3Rpb25zLFxuICAgIGNvbm5lY3RlZCxcbiAgICBkaXNjb25uZWN0ZWQsXG4gICAgbXNnSWQsXG4gICAgb25JbixcbiAgICBvbk91dCxcbiAgICBwcm9jZXNzSW4sXG4gICAgcHJvY2Vzc091dCxcbiAgICBzdHJpbmdpZnksXG4gICAgZGlmZk5vZGVcbiAgfTtcbiAgcmV0dXJuIHBlZXI7XG59XG4iLCJpbXBvcnQgKiBhcyBSIGZyb20gXCJyYW1kYVwiO1xuXG5jb25zdCBHUkFDRSA9IDEwICogNjAgKiAxMDAwOyAvLyBIb3cgZmFyIGFoZWFkIGNsb2NrIGNhbiBiZSwgdW5saWtlIGd1biB3ZSBqdXN0IGRpc2NhcmQgbm90IGRlZmVyXG5jb25zdCBMZXhpY2FsID0gSlNPTi5zdHJpbmdpZnk7IC8vIFRoaXMgaXMgd2hhdCBHdW4gdXNlc1xuXG5leHBvcnQgY29uc3QgZGlmZk5vZGUgPSAoZXhpc3RpbmcsIHVwZGF0ZWQsIG1hY2hpbmVTdGF0ZSA9IG51bGwpID0+IHtcbiAgbGV0IG1heFN0YXRlID0gKG1hY2hpbmVTdGF0ZSB8fCBuZXcgRGF0ZSgpLmdldFRpbWUoKSkgKyBHUkFDRTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICBjb25zdCBleGlzdGluZ1N0YXRlID0gUi5wYXRoKFtcIl9cIiwgXCI+XCJdLCBleGlzdGluZykgfHwge307XG4gIGNvbnN0IHVwZGF0ZWRTdGF0ZSA9IFIucGF0aChbXCJfXCIsIFwiPlwiXSwgdXBkYXRlZCkgfHwge307XG5cbiAgcmV0dXJuIFIuY29tcG9zZShcbiAgICB2YWxzID0+IHtcbiAgICAgIGNvbnN0IGtleXMgPSBSLmtleXModmFscyk7XG5cbiAgICAgIGlmICgha2V5cy5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgcmV0dXJuIFIuYXNzb2MoXG4gICAgICAgIFwiX1wiLFxuICAgICAgICBSLmFzc29jKFwiPlwiLCBSLnBpY2soa2V5cywgdXBkYXRlZFN0YXRlKSwgdXBkYXRlZC5fKSxcbiAgICAgICAgdmFsc1xuICAgICAgKTtcbiAgICB9LFxuICAgIFIucmVkdWNlKCh1cGRhdGVzLCBrZXkpID0+IHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nS2V5U3RhdGUgPSBleGlzdGluZ1N0YXRlW2tleV07XG4gICAgICBjb25zdCB1cGRhdGVkS2V5U3RhdGUgPSB1cGRhdGVkU3RhdGVba2V5XTtcblxuICAgICAgaWYgKHVwZGF0ZWRLZXlTdGF0ZSA+IG1heFN0YXRlIHx8ICF1cGRhdGVkS2V5U3RhdGUpIHJldHVybiB1cGRhdGVzO1xuICAgICAgaWYgKGV4aXN0aW5nS2V5U3RhdGUgJiYgZXhpc3RpbmdLZXlTdGF0ZSA+PSB1cGRhdGVkS2V5U3RhdGUpXG4gICAgICAgIHJldHVybiB1cGRhdGVzO1xuXG4gICAgICBpZiAoZXhpc3RpbmdLZXlTdGF0ZSA9PT0gdXBkYXRlZEtleVN0YXRlKSB7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nVmFsID0gUi5wcm9wKGtleSwgZXhpc3RpbmcpO1xuICAgICAgICBjb25zdCB1cGRhdGVkVmFsID0gUi5wcm9wKGtleSwgdXBkYXRlZCk7XG5cbiAgICAgICAgLy8gVGhpcyBpcyBiYXNlZCBvbiBHdW4ncyBsb2dpY1xuICAgICAgICBpZiAoTGV4aWNhbCh1cGRhdGVkVmFsKSA8PSBMZXhpY2FsKGV4aXN0aW5nVmFsKSkgcmV0dXJuIHVwZGF0ZWQ7XG4gICAgICB9XG4gICAgICB1cGRhdGVzW2tleV0gPSB1cGRhdGVkW2tleV07XG4gICAgICByZXR1cm4gdXBkYXRlcztcbiAgICB9LCB7fSksXG4gICAgUi5rZXlzXG4gICkodXBkYXRlZFN0YXRlKTtcbn07XG4iLCJpbXBvcnQgeyBwYXRoLCBrZXlzIH0gZnJvbSBcInJhbWRhXCI7XG5jb25zdCBNQVhfTVNHX0lEX0NBQ0hFID0gNTAwMDA7XG5jb25zdCBHQVJCQUdFX0lOVEVSVkFMID0gNjAwMDA7XG5cbmV4cG9ydCBkZWZhdWx0IGRiID0+IHtcbiAgY29uc3QgcmVjZWl2ZWRJZHMgPSB7fTtcblxuICBmdW5jdGlvbiBjb2xsZWN0R2FyYmFnZSgpIHtcbiAgICBsZXQgaWRzID0ga2V5cyhyZWNlaXZlZElkcykucmV2ZXJzZSgpO1xuXG4gICAgd2hpbGUgKGlkcy5sZW5ndGggPiBNQVhfTVNHX0lEX0NBQ0hFKSB7XG4gICAgICBkZWxldGUgcmVjZWl2ZWRJZHNbaWRzLnBvcCgpXTtcbiAgICB9XG4gIH1cblxuICBkYi5vbkluKG1zZyA9PiB7XG4gICAgY29uc3QgaWQgPSBwYXRoKFtcImpzb25cIiwgXCIjXCJdLCBtc2cpO1xuXG4gICAgaWYgKCFpZCB8fCByZWNlaXZlZElkc1tpZF0pIHJldHVybiBudWxsO1xuICAgIHJlY2VpdmVkSWRzW2lkXSA9IHRydWU7XG4gICAgcmV0dXJuIG1zZztcbiAgfSk7XG5cbiAgc2V0SW50ZXJ2YWwoY29sbGVjdEdhcmJhZ2UsIEdBUkJBR0VfSU5URVJWQUwpO1xuXG4gIHJldHVybiBkYjtcbn07XG4iLCJpbXBvcnQgeyBwYXRoLCBrZXlzIH0gZnJvbSBcInJhbWRhXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGRiID0+IHtcbiAgZGIub25Jbihtc2cgPT4ge1xuICAgIGlmICghbXNnLmZyb20gfHwgIW1zZy5mcm9tLnNldCkgcmV0dXJuIG1zZztcbiAgICBpZiAocGF0aChbXCJqc29uXCIsIFwibGVlY2hcIl0sIG1zZykpIHtcbiAgICAgIG1zZy5mcm9tLnNldChbXCJpc0xlZWNoaW5nXCJdLCB0cnVlKTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbnN0IGFza2luZ0ZvciA9IHBhdGgoW1wianNvblwiLCBcImdldFwiLCBcIiNcIl0sIG1zZyk7XG5cbiAgICBbYXNraW5nRm9yLCAuLi5rZXlzKHBhdGgoW1wianNvblwiLCBcInB1dFwiXSwgbXNnKSldLmZvckVhY2goXG4gICAgICBzb3VsID0+IHNvdWwgJiYgbXNnLmZyb20uc2V0KFtcImhhc0Fza2VkRm9yXCIsIHNvdWxdLCB0cnVlKVxuICAgICk7XG4gICAgcmV0dXJuIG1zZztcbiAgfSk7XG5cbiAgZGIub25PdXQobXNnID0+IHtcbiAgICBjb25zdCB7IHRvLCBqc29uLCBpZ25vcmVMZWVjaGluZyB9ID0gbXNnO1xuXG4gICAgaWYgKCF0by5nZXQoW1wiaXNMZWVjaGluZ1wiXSkgfHwgaWdub3JlTGVlY2hpbmcpIHJldHVybiBtc2c7XG4gICAgY29uc3QgYXNrZWRQdXRzID0ga2V5cyhqc29uLnB1dCkuZmlsdGVyKHNvdWwgPT4ge1xuICAgICAgaWYgKCF0by5nZXQoW1wiaGFzQXNrZWRGb3JcIiwgc291bF0pKSByZXR1cm4gZmFsc2U7XG4gICAgICBjb25zdCBzb3VsRGVsdGFzID0gcGF0aChbc291bCwgXCJfXCIsIFwiPlwiXSwganNvbi5wdXQpO1xuICAgICAgbGV0IGhhc1VwZGF0ZXMgPSBmYWxzZTtcblxuICAgICAgaWYgKCFrZXlzKHNvdWxEZWx0YXMpLmxlbmd0aCkgcmV0dXJuIHRydWU7XG5cbiAgICAgIGtleXMoc291bERlbHRhcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBjb25zdCBrbm93biA9IHRvLmdldChbXCJrbm93bkRlbHRhc1wiLCBzb3VsLCBrZXldKSB8fCAwO1xuICAgICAgICBjb25zdCBkZWx0YSA9IHBhcnNlRmxvYXQoc291bERlbHRhc1trZXldKSB8fCAwO1xuXG4gICAgICAgIGlmIChrbm93biAmJiBkZWx0YSA8PSBrbm93bikgcmV0dXJuO1xuICAgICAgICB0by5zZXQoW1wia25vd25EZWx0YXNcIiwgc291bCwga2V5XSwgZGVsdGEpO1xuICAgICAgICBoYXNVcGRhdGVzID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGhhc1VwZGF0ZXM7XG4gICAgfSk7XG5cbiAgICBpZiAoYXNrZWRQdXRzLmxlbmd0aCkgcmV0dXJuIG1zZztcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9KTtcblxuICByZXR1cm4gZGI7XG59O1xuIiwiaW1wb3J0ICogYXMgUiBmcm9tIFwicmFtZGFcIjtcblxubW9kdWxlLmV4cG9ydHMgPSBkYiA9PiB7XG4gIGRiLm9uSW4obXNnID0+IHtcbiAgICBjb25zdCB7IGZyb20sIG5vUmVsYXkgfSA9IG1zZztcblxuICAgIGlmIChub1JlbGF5KSByZXR1cm4gbXNnO1xuICAgIFIud2l0aG91dChbZnJvbV0sIGRiLmNvbm5lY3Rpb25zKS5mb3JFYWNoKGMgPT5cbiAgICAgIGMuc2VuZChSLmFzc29jKFwic2tpcFZhbGlkYXRpb25cIiwgdHJ1ZSwgbXNnKSlcbiAgICApO1xuICAgIHJldHVybiBtc2c7XG4gIH0pO1xuICByZXR1cm4gZGI7XG59O1xuIiwiaW1wb3J0ICogYXMgUiBmcm9tIFwicmFtZGFcIjtcbmltcG9ydCB1dWlkIGZyb20gXCJ1dWlkXCI7XG5cbmNvbnN0IE1TR19UT1BJQyA9IFwiZ3VuOm1zZ1wiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGRiID0+IHtcbiAgY29uc3QgcG0yID0gcmVxdWlyZShcInBtMlwiKTtcbiAgY29uc3QgaWQgPSB1dWlkLnY0KCk7XG5cbiAgcG0yLmxhdW5jaEJ1cygoZXJyLCBidXMpID0+IHtcbiAgICBpZiAoZXJyKSBjb25zb2xlLmVycihlcnIpO1xuICAgIGJ1cy5vbihcInByb2Nlc3M6bXNnXCIsIHBhY2tldCA9PiB7XG4gICAgICBpZiAocGFja2V0LnJhdy5tc2cuZnJvbUNsdXN0ZXIgPT09IGlkKSByZXR1cm47XG4gICAgICBpZiAocGFja2V0LnJhdy50b3BpYyA9PT0gTVNHX1RPUElDKSB7XG4gICAgICAgIGRiLnByb2Nlc3NJbihSLmFzc29jKFwiZGJcIiwgZGIsIHBhY2tldC5yYXcubXNnKSkuY2F0Y2goZXJyID0+XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIlBJU1RPTCBjbHVzdGVyIGVyclwiLCBlcnIpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRiLm9uSW4obXNnID0+IHtcbiAgICBjb25zdCB7IGZyb21DbHVzdGVyLCBub1JlbGF5IH0gPSBtc2c7XG5cbiAgICBpZiAobm9SZWxheSB8fCBmcm9tQ2x1c3RlcikgcmV0dXJuIG1zZztcbiAgICBpZiAocHJvY2Vzcy5zZW5kKSB7XG4gICAgICBwcm9jZXNzLnNlbmQoe1xuICAgICAgICB0b3BpYzogTVNHX1RPUElDLFxuICAgICAgICBtc2c6IFIubWVyZ2VMZWZ0KHsgZnJvbUNsdXN0ZXI6IGlkLCBza2lwVmFsaWRhdGlvbjogdHJ1ZSB9LCBtc2cpXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG1zZztcbiAgfSk7XG5cbiAgcmV0dXJuIGRiO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMTBfXzsiLCJpbXBvcnQgeyBjdXJyeSB9IGZyb20gXCJyYW1kYVwiO1xuaW1wb3J0IFdTIGZyb20gXCJ3c1wiO1xuaW1wb3J0IFJlY29ubmVjdGluZ1dlYlNvY2tldCBmcm9tIFwicmVjb25uZWN0aW5nLXdlYnNvY2tldFwiO1xuXG5jb25zdCBQSU5HID0gNjAwMDA7XG5cbmNvbnN0IHdzQ29ubmVjdGlvbiA9IGN1cnJ5KChkYiwgd3MpID0+IHtcbiAgbGV0IGhhc0xvZ2dlZEVyciA9IGZhbHNlO1xuICBsZXQgY29ubmVjdGVkID0gdHJ1ZTtcblxuICBjb25zdCBjb25uZWN0aW9uID0gZGIuY29ubmVjdGVkKG1zZyA9PiB7XG4gICAgaWYgKCFtc2cgfHwgIShtc2cuanNvbiB8fCBtc2cucmF3KSB8fCAhY29ubmVjdGVkKSByZXR1cm47XG4gICAgY29uc3QgcmF3ID0gbXNnLnJhdyB8fCBkYi5zdHJpbmdpZnkobXNnLmpzb24pO1xuXG4gICAgd3Muc2VuZChyYXcsIGVyciA9PiB7XG4gICAgICBpZiAoIWVyciB8fCBoYXNMb2dnZWRFcnIpIHJldHVybjtcbiAgICAgIGNvbnNvbGUud2FybihcIndzIHNlbmQgZXJyXCIsIGVycik7XG4gICAgICBoYXNMb2dnZWRFcnIgPSB0cnVlO1xuICAgIH0pO1xuICB9KTtcblxuICBjb25zdCBwaW5nSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChcbiAgICAoKSA9PiBjb25uZWN0aW9uLnNlbmQoeyBqc29uOiBbXSwgc2tpcFZhbGlkYXRpb246IHRydWUgfSksXG4gICAgUElOR1xuICApO1xuXG4gIGNvbnN0IHJlY2VpdmUgPSBtc2cgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByYXcgPSBtc2cuZGF0YSB8fCBtc2c7XG4gICAgICBjb25zdCBqc29uID0gdHlwZW9mIHJhdyA9PT0gXCJzdHJpbmdcIiA/IEpTT04ucGFyc2UocmF3KSA6IHJhdztcblxuICAgICAgQXJyYXkuaXNBcnJheShqc29uKVxuICAgICAgICA/IGpzb24uZm9yRWFjaChyZWNlaXZlKVxuICAgICAgICA6IGNvbm5lY3Rpb24ucmVjZWl2ZSh7IGpzb24sIHJhdyB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiUkVDRUlWRVIgaW52YWxpZCB3cyBtc2dcIiwgZSwgbXNnLmRhdGEgfHwgbXNnKTtcbiAgICB9XG4gIH07XG5cbiAgd3MuYWRkRXZlbnRMaXN0ZW5lcihcImNsb3NlXCIsICgpID0+IHtcbiAgICBpZiAod3MucmVjb25uZWN0KSByZXR1cm47XG4gICAgY29ubmVjdGVkID0gZmFsc2U7XG4gICAgY2xlYXJJbnRlcnZhbChwaW5nSW50ZXJ2YWwpO1xuICAgIGRiLmRpc2Nvbm5lY3RlZChjb25uZWN0aW9uKTtcbiAgfSk7XG5cbiAgd3MuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgcmVjZWl2ZSk7XG4gIHJldHVybiBjb25uZWN0aW9uO1xufSk7XG5cbmV4cG9ydCBjb25zdCBzZXJ2ZXIgPSBjdXJyeSgoeyB3ZWIsIHBvcnQgfSwgZGIpID0+IHtcbiAgbmV3IFdTLlNlcnZlcih7IHBvcnQ6ICF3ZWIgPyBwb3J0IDogdW5kZWZpbmVkLCBzZXJ2ZXI6IHdlYiB9KS5vbihcbiAgICBcImNvbm5lY3Rpb25cIixcbiAgICB3c0Nvbm5lY3Rpb24oZGIpXG4gICk7XG4gIHJldHVybiBkYjtcbn0pO1xuXG5leHBvcnQgY29uc3QgY2xpZW50ID0gY3VycnkoKHVybCwgZGIpID0+IHtcbiAgY29uc3Qgd3MgPSBuZXcgUmVjb25uZWN0aW5nV2ViU29ja2V0KHVybCwgW10sIHsgV2ViU29ja2V0OiBXUyB9KTtcblxuICB3cy5hZGRFdmVudExpc3RlbmVyKFwib3BlblwiLCAoKSA9PiB3c0Nvbm5lY3Rpb24oZGIsIHdzKSk7XG4gIHJldHVybiBkYjtcbn0pO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xMl9fOyIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cblxudmFyIEV2ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXZlbnQodHlwZSwgdGFyZ2V0KSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgIH1cclxuICAgIHJldHVybiBFdmVudDtcclxufSgpKTtcclxudmFyIEVycm9yRXZlbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoRXJyb3JFdmVudCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEVycm9yRXZlbnQoZXJyb3IsIHRhcmdldCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICdlcnJvcicsIHRhcmdldCkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5tZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcclxuICAgICAgICBfdGhpcy5lcnJvciA9IGVycm9yO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBFcnJvckV2ZW50O1xyXG59KEV2ZW50KSk7XHJcbnZhciBDbG9zZUV2ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKENsb3NlRXZlbnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBDbG9zZUV2ZW50KGNvZGUsIHJlYXNvbiwgdGFyZ2V0KSB7XHJcbiAgICAgICAgaWYgKGNvZGUgPT09IHZvaWQgMCkgeyBjb2RlID0gMTAwMDsgfVxyXG4gICAgICAgIGlmIChyZWFzb24gPT09IHZvaWQgMCkgeyByZWFzb24gPSAnJzsgfVxyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICdjbG9zZScsIHRhcmdldCkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy53YXNDbGVhbiA9IHRydWU7XHJcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgX3RoaXMucmVhc29uID0gcmVhc29uO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBDbG9zZUV2ZW50O1xyXG59KEV2ZW50KSk7XG5cbi8qIVxyXG4gKiBSZWNvbm5lY3RpbmcgV2ViU29ja2V0XHJcbiAqIGJ5IFBlZHJvIExhZGFyaWEgPHBlZHJvLmxhZGFyaWFAZ21haWwuY29tPlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vcGxhZGFyaWEvcmVjb25uZWN0aW5nLXdlYnNvY2tldFxyXG4gKiBMaWNlbnNlIE1JVFxyXG4gKi9cclxudmFyIGdldEdsb2JhbFdlYlNvY2tldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0eXBlb2YgV2ViU29ja2V0ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICByZXR1cm4gV2ViU29ja2V0O1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogUmV0dXJucyB0cnVlIGlmIGdpdmVuIGFyZ3VtZW50IGxvb2tzIGxpa2UgYSBXZWJTb2NrZXQgY2xhc3NcclxuICovXHJcbnZhciBpc1dlYlNvY2tldCA9IGZ1bmN0aW9uICh3KSB7IHJldHVybiB0eXBlb2YgdyA9PT0gJ2Z1bmN0aW9uJyAmJiB3LkNMT1NJTkcgPT09IDI7IH07XHJcbnZhciBERUZBVUxUID0ge1xyXG4gICAgbWF4UmVjb25uZWN0aW9uRGVsYXk6IDEwMDAwLFxyXG4gICAgbWluUmVjb25uZWN0aW9uRGVsYXk6IDEwMDAgKyBNYXRoLnJhbmRvbSgpICogNDAwMCxcclxuICAgIG1pblVwdGltZTogNTAwMCxcclxuICAgIHJlY29ubmVjdGlvbkRlbGF5R3Jvd0ZhY3RvcjogMS4zLFxyXG4gICAgY29ubmVjdGlvblRpbWVvdXQ6IDQwMDAsXHJcbiAgICBtYXhSZXRyaWVzOiBJbmZpbml0eSxcclxuICAgIGRlYnVnOiBmYWxzZSxcclxufTtcclxudmFyIFJlY29ubmVjdGluZ1dlYlNvY2tldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlY29ubmVjdGluZ1dlYlNvY2tldCh1cmwsIHByb3RvY29scywgb3B0aW9ucykge1xyXG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSB7XHJcbiAgICAgICAgICAgIGVycm9yOiBbXSxcclxuICAgICAgICAgICAgbWVzc2FnZTogW10sXHJcbiAgICAgICAgICAgIG9wZW46IFtdLFxyXG4gICAgICAgICAgICBjbG9zZTogW10sXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9yZXRyeUNvdW50ID0gLTE7XHJcbiAgICAgICAgdGhpcy5fc2hvdWxkUmVjb25uZWN0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9jb25uZWN0TG9jayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2JpbmFyeVR5cGUgPSAnYmxvYic7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VDYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9tZXNzYWdlUXVldWUgPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBldmVudCBsaXN0ZW5lciB0byBiZSBjYWxsZWQgd2hlbiB0aGUgV2ViU29ja2V0IGNvbm5lY3Rpb24ncyByZWFkeVN0YXRlIGNoYW5nZXMgdG8gQ0xPU0VEXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5vbmNsb3NlID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFuIGV2ZW50IGxpc3RlbmVyIHRvIGJlIGNhbGxlZCB3aGVuIGFuIGVycm9yIG9jY3Vyc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMub25lcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBldmVudCBsaXN0ZW5lciB0byBiZSBjYWxsZWQgd2hlbiBhIG1lc3NhZ2UgaXMgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5vbm1lc3NhZ2UgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQW4gZXZlbnQgbGlzdGVuZXIgdG8gYmUgY2FsbGVkIHdoZW4gdGhlIFdlYlNvY2tldCBjb25uZWN0aW9uJ3MgcmVhZHlTdGF0ZSBjaGFuZ2VzIHRvIE9QRU47XHJcbiAgICAgICAgICogdGhpcyBpbmRpY2F0ZXMgdGhhdCB0aGUgY29ubmVjdGlvbiBpcyByZWFkeSB0byBzZW5kIGFuZCByZWNlaXZlIGRhdGFcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm9ub3BlbiA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVPcGVuID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9kZWJ1Zygnb3BlbiBldmVudCcpO1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBfdGhpcy5fb3B0aW9ucy5taW5VcHRpbWUsIG1pblVwdGltZSA9IF9hID09PSB2b2lkIDAgPyBERUZBVUxULm1pblVwdGltZSA6IF9hO1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMuX2Nvbm5lY3RUaW1lb3V0KTtcclxuICAgICAgICAgICAgX3RoaXMuX3VwdGltZVRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9hY2NlcHRPcGVuKCk7IH0sIG1pblVwdGltZSk7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgX3RoaXMuX3dzLmJpbmFyeVR5cGUgPSBfdGhpcy5fYmluYXJ5VHlwZTtcclxuICAgICAgICAgICAgLy8gc2VuZCBlbnF1ZXVlZCBtZXNzYWdlcyAobWVzc2FnZXMgc2VudCBiZWZvcmUgd2Vic29ja2V0IG9wZW4gZXZlbnQpXHJcbiAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlUXVldWUuZm9yRWFjaChmdW5jdGlvbiAobWVzc2FnZSkgeyByZXR1cm4gX3RoaXMuX3dzLnNlbmQobWVzc2FnZSk7IH0pO1xyXG4gICAgICAgICAgICBfdGhpcy5fbWVzc2FnZVF1ZXVlID0gW107XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5vbm9wZW4pIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9ub3BlbihldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuX2xpc3RlbmVycy5vcGVuLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7IHJldHVybiBfdGhpcy5fY2FsbEV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTsgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVNZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9kZWJ1ZygnbWVzc2FnZSBldmVudCcpO1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMub25tZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vbm1lc3NhZ2UoZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzLl9saXN0ZW5lcnMubWVzc2FnZS5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikgeyByZXR1cm4gX3RoaXMuX2NhbGxFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7IH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgX3RoaXMuX2RlYnVnKCdlcnJvciBldmVudCcsIGV2ZW50Lm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBfdGhpcy5fZGlzY29ubmVjdCh1bmRlZmluZWQsIGV2ZW50Lm1lc3NhZ2UgPT09ICdUSU1FT1VUJyA/ICd0aW1lb3V0JyA6IHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5vbmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vbmVycm9yKGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpcy5fZGVidWcoJ2V4ZWMgZXJyb3IgbGlzdGVuZXJzJyk7XHJcbiAgICAgICAgICAgIF90aGlzLl9saXN0ZW5lcnMuZXJyb3IuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsgcmV0dXJuIF90aGlzLl9jYWxsRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpOyB9KTtcclxuICAgICAgICAgICAgX3RoaXMuX2Nvbm5lY3QoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIF90aGlzLl9kZWJ1ZygnY2xvc2UgZXZlbnQnKTtcclxuICAgICAgICAgICAgX3RoaXMuX2NsZWFyVGltZW91dHMoKTtcclxuICAgICAgICAgICAgaWYgKF90aGlzLl9zaG91bGRSZWNvbm5lY3QpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLl9jb25uZWN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKF90aGlzLm9uY2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9uY2xvc2UoZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzLl9saXN0ZW5lcnMuY2xvc2UuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsgcmV0dXJuIF90aGlzLl9jYWxsRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpOyB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3VybCA9IHVybDtcclxuICAgICAgICB0aGlzLl9wcm90b2NvbHMgPSBwcm90b2NvbHM7XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5fY29ubmVjdCgpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlY29ubmVjdGluZ1dlYlNvY2tldCwgXCJDT05ORUNUSU5HXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVjb25uZWN0aW5nV2ViU29ja2V0LCBcIk9QRU5cIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWNvbm5lY3RpbmdXZWJTb2NrZXQsIFwiQ0xPU0lOR1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlY29ubmVjdGluZ1dlYlNvY2tldCwgXCJDTE9TRURcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLCBcIkNPTk5FQ1RJTkdcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUmVjb25uZWN0aW5nV2ViU29ja2V0LkNPTk5FQ1RJTkc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZSwgXCJPUEVOXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFJlY29ubmVjdGluZ1dlYlNvY2tldC5PUEVOO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUsIFwiQ0xPU0lOR1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZWNvbm5lY3RpbmdXZWJTb2NrZXQuQ0xPU0lORztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLCBcIkNMT1NFRFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZWNvbm5lY3RpbmdXZWJTb2NrZXQuQ0xPU0VEO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUsIFwiYmluYXJ5VHlwZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93cyA/IHRoaXMuX3dzLmJpbmFyeVR5cGUgOiB0aGlzLl9iaW5hcnlUeXBlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fYmluYXJ5VHlwZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fd3MpIHtcclxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgICAgIHRoaXMuX3dzLmJpbmFyeVR5cGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUsIFwicmV0cnlDb3VudFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9yIGNvbm5lY3Rpb24gcmV0cmllc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5fcmV0cnlDb3VudCwgMCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZSwgXCJidWZmZXJlZEFtb3VudFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBieXRlcyBvZiBkYXRhIHRoYXQgaGF2ZSBiZWVuIHF1ZXVlZCB1c2luZyBjYWxscyB0byBzZW5kKCkgYnV0IG5vdCB5ZXRcclxuICAgICAgICAgKiB0cmFuc21pdHRlZCB0byB0aGUgbmV0d29yay4gVGhpcyB2YWx1ZSByZXNldHMgdG8gemVybyBvbmNlIGFsbCBxdWV1ZWQgZGF0YSBoYXMgYmVlbiBzZW50LlxyXG4gICAgICAgICAqIFRoaXMgdmFsdWUgZG9lcyBub3QgcmVzZXQgdG8gemVybyB3aGVuIHRoZSBjb25uZWN0aW9uIGlzIGNsb3NlZDsgaWYgeW91IGtlZXAgY2FsbGluZyBzZW5kKCksXHJcbiAgICAgICAgICogdGhpcyB3aWxsIGNvbnRpbnVlIHRvIGNsaW1iLiBSZWFkIG9ubHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5fbWVzc2FnZVF1ZXVlLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjICs9IG1lc3NhZ2UubGVuZ3RoOyAvLyBub3QgYnl0ZSBzaXplXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgQmxvYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjYyArPSBtZXNzYWdlLnNpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhY2MgKz0gbWVzc2FnZS5ieXRlTGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcclxuICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIHJldHVybiBieXRlcyArICh0aGlzLl93cyA/IHRoaXMuX3dzLmJ1ZmZlcmVkQW1vdW50IDogMCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZSwgXCJleHRlbnNpb25zXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgZXh0ZW5zaW9ucyBzZWxlY3RlZCBieSB0aGUgc2VydmVyLiBUaGlzIGlzIGN1cnJlbnRseSBvbmx5IHRoZSBlbXB0eSBzdHJpbmcgb3IgYSBsaXN0IG9mXHJcbiAgICAgICAgICogZXh0ZW5zaW9ucyBhcyBuZWdvdGlhdGVkIGJ5IHRoZSBjb25uZWN0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93cyA/IHRoaXMuX3dzLmV4dGVuc2lvbnMgOiAnJztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLCBcInByb3RvY29sXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIHN0cmluZyBpbmRpY2F0aW5nIHRoZSBuYW1lIG9mIHRoZSBzdWItcHJvdG9jb2wgdGhlIHNlcnZlciBzZWxlY3RlZDtcclxuICAgICAgICAgKiB0aGlzIHdpbGwgYmUgb25lIG9mIHRoZSBzdHJpbmdzIHNwZWNpZmllZCBpbiB0aGUgcHJvdG9jb2xzIHBhcmFtZXRlciB3aGVuIGNyZWF0aW5nIHRoZVxyXG4gICAgICAgICAqIFdlYlNvY2tldCBvYmplY3RcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dzID8gdGhpcy5fd3MucHJvdG9jb2wgOiAnJztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLCBcInJlYWR5U3RhdGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBjb25uZWN0aW9uOyB0aGlzIGlzIG9uZSBvZiB0aGUgUmVhZHkgc3RhdGUgY29uc3RhbnRzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93cyA/IHRoaXMuX3dzLnJlYWR5U3RhdGUgOiBSZWNvbm5lY3RpbmdXZWJTb2NrZXQuQ09OTkVDVElORztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLCBcInVybFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIFVSTCBhcyByZXNvbHZlZCBieSB0aGUgY29uc3RydWN0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dzID8gdGhpcy5fd3MudXJsIDogJyc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIENsb3NlcyB0aGUgV2ViU29ja2V0IGNvbm5lY3Rpb24gb3IgY29ubmVjdGlvbiBhdHRlbXB0LCBpZiBhbnkuIElmIHRoZSBjb25uZWN0aW9uIGlzIGFscmVhZHlcclxuICAgICAqIENMT1NFRCwgdGhpcyBtZXRob2QgZG9lcyBub3RoaW5nXHJcbiAgICAgKi9cclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoY29kZSwgcmVhc29uKSB7XHJcbiAgICAgICAgaWYgKGNvZGUgPT09IHZvaWQgMCkgeyBjb2RlID0gMTAwMDsgfVxyXG4gICAgICAgIHRoaXMuX2Nsb3NlQ2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9zaG91bGRSZWNvbm5lY3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9jbGVhclRpbWVvdXRzKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLl93cykge1xyXG4gICAgICAgICAgICB0aGlzLl9kZWJ1ZygnY2xvc2UgZW5xdWV1ZWQ6IG5vIHdzIGluc3RhbmNlJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3dzLnJlYWR5U3RhdGUgPT09IHRoaXMuQ0xPU0VEKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlYnVnKCdjbG9zZTogYWxyZWFkeSBjbG9zZWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl93cy5jbG9zZShjb2RlLCByZWFzb24pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2xvc2VzIHRoZSBXZWJTb2NrZXQgY29ubmVjdGlvbiBvciBjb25uZWN0aW9uIGF0dGVtcHQgYW5kIGNvbm5lY3RzIGFnYWluLlxyXG4gICAgICogUmVzZXRzIHJldHJ5IGNvdW50ZXI7XHJcbiAgICAgKi9cclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUucmVjb25uZWN0ID0gZnVuY3Rpb24gKGNvZGUsIHJlYXNvbikge1xyXG4gICAgICAgIHRoaXMuX3Nob3VsZFJlY29ubmVjdCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VDYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9yZXRyeUNvdW50ID0gLTE7XHJcbiAgICAgICAgaWYgKCF0aGlzLl93cyB8fCB0aGlzLl93cy5yZWFkeVN0YXRlID09PSB0aGlzLkNMT1NFRCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jb25uZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNjb25uZWN0KGNvZGUsIHJlYXNvbik7XHJcbiAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3QoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBFbnF1ZXVlIHNwZWNpZmllZCBkYXRhIHRvIGJlIHRyYW5zbWl0dGVkIHRvIHRoZSBzZXJ2ZXIgb3ZlciB0aGUgV2ViU29ja2V0IGNvbm5lY3Rpb25cclxuICAgICAqL1xyXG4gICAgUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBpZiAodGhpcy5fd3MgJiYgdGhpcy5fd3MucmVhZHlTdGF0ZSA9PT0gdGhpcy5PUEVOKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlYnVnKCdzZW5kJywgZGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3dzLnNlbmQoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9kZWJ1ZygnZW5xdWV1ZScsIGRhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLl9tZXNzYWdlUXVldWUucHVzaChkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlciBhbiBldmVudCBoYW5kbGVyIG9mIGEgc3BlY2lmaWMgZXZlbnQgdHlwZVxyXG4gICAgICovXHJcbiAgICBSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAodHlwZSwgbGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5fbGlzdGVuZXJzW3R5cGVdKSB7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgdGhpcy5fbGlzdGVuZXJzW3R5cGVdLnB1c2gobGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgYW4gZXZlbnQgbGlzdGVuZXJcclxuICAgICAqL1xyXG4gICAgUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xpc3RlbmVyc1t0eXBlXSkge1xyXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVyc1t0eXBlXSA9IHRoaXMuX2xpc3RlbmVyc1t0eXBlXS5maWx0ZXIoZnVuY3Rpb24gKGwpIHsgcmV0dXJuIGwgIT09IGxpc3RlbmVyOyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZS5fZGVidWcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9vcHRpb25zLmRlYnVnKSB7XHJcbiAgICAgICAgICAgIC8vIG5vdCB1c2luZyBzcHJlYWQgYmVjYXVzZSBjb21waWxlZCB2ZXJzaW9uIHVzZXMgU3ltYm9sc1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgWydSV1M+J10uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZS5fZ2V0TmV4dERlbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfYSA9IHRoaXMuX29wdGlvbnMsIF9iID0gX2EucmVjb25uZWN0aW9uRGVsYXlHcm93RmFjdG9yLCByZWNvbm5lY3Rpb25EZWxheUdyb3dGYWN0b3IgPSBfYiA9PT0gdm9pZCAwID8gREVGQVVMVC5yZWNvbm5lY3Rpb25EZWxheUdyb3dGYWN0b3IgOiBfYiwgX2MgPSBfYS5taW5SZWNvbm5lY3Rpb25EZWxheSwgbWluUmVjb25uZWN0aW9uRGVsYXkgPSBfYyA9PT0gdm9pZCAwID8gREVGQVVMVC5taW5SZWNvbm5lY3Rpb25EZWxheSA6IF9jLCBfZCA9IF9hLm1heFJlY29ubmVjdGlvbkRlbGF5LCBtYXhSZWNvbm5lY3Rpb25EZWxheSA9IF9kID09PSB2b2lkIDAgPyBERUZBVUxULm1heFJlY29ubmVjdGlvbkRlbGF5IDogX2Q7XHJcbiAgICAgICAgdmFyIGRlbGF5ID0gbWluUmVjb25uZWN0aW9uRGVsYXk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3JldHJ5Q291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGRlbGF5ID1cclxuICAgICAgICAgICAgICAgIG1pblJlY29ubmVjdGlvbkRlbGF5ICogTWF0aC5wb3cocmVjb25uZWN0aW9uRGVsYXlHcm93RmFjdG9yLCB0aGlzLl9yZXRyeUNvdW50IC0gMSk7XHJcbiAgICAgICAgICAgIGlmIChkZWxheSA+IG1heFJlY29ubmVjdGlvbkRlbGF5KSB7XHJcbiAgICAgICAgICAgICAgICBkZWxheSA9IG1heFJlY29ubmVjdGlvbkRlbGF5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2RlYnVnKCduZXh0IGRlbGF5JywgZGVsYXkpO1xyXG4gICAgICAgIHJldHVybiBkZWxheTtcclxuICAgIH07XHJcbiAgICBSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLl93YWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgX3RoaXMuX2dldE5leHREZWxheSgpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLl9nZXROZXh0VXJsID0gZnVuY3Rpb24gKHVybFByb3ZpZGVyKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB1cmxQcm92aWRlciA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1cmxQcm92aWRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgdXJsUHJvdmlkZXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHVybFByb3ZpZGVyKCk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1cmwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh1cmwudGhlbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBFcnJvcignSW52YWxpZCBVUkwnKTtcclxuICAgIH07XHJcbiAgICBSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLl9jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Nvbm5lY3RMb2NrIHx8ICF0aGlzLl9zaG91bGRSZWNvbm5lY3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jb25uZWN0TG9jayA9IHRydWU7XHJcbiAgICAgICAgdmFyIF9hID0gdGhpcy5fb3B0aW9ucywgX2IgPSBfYS5tYXhSZXRyaWVzLCBtYXhSZXRyaWVzID0gX2IgPT09IHZvaWQgMCA/IERFRkFVTFQubWF4UmV0cmllcyA6IF9iLCBfYyA9IF9hLmNvbm5lY3Rpb25UaW1lb3V0LCBjb25uZWN0aW9uVGltZW91dCA9IF9jID09PSB2b2lkIDAgPyBERUZBVUxULmNvbm5lY3Rpb25UaW1lb3V0IDogX2MsIF9kID0gX2EuV2ViU29ja2V0LCBXZWJTb2NrZXQgPSBfZCA9PT0gdm9pZCAwID8gZ2V0R2xvYmFsV2ViU29ja2V0KCkgOiBfZDtcclxuICAgICAgICBpZiAodGhpcy5fcmV0cnlDb3VudCA+PSBtYXhSZXRyaWVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlYnVnKCdtYXggcmV0cmllcyByZWFjaGVkJywgdGhpcy5fcmV0cnlDb3VudCwgJz49JywgbWF4UmV0cmllcyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcmV0cnlDb3VudCsrO1xyXG4gICAgICAgIHRoaXMuX2RlYnVnKCdjb25uZWN0JywgdGhpcy5fcmV0cnlDb3VudCk7XHJcbiAgICAgICAgdGhpcy5fcmVtb3ZlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgaWYgKCFpc1dlYlNvY2tldChXZWJTb2NrZXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdObyB2YWxpZCBXZWJTb2NrZXQgY2xhc3MgcHJvdmlkZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fd2FpdCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9nZXROZXh0VXJsKF90aGlzLl91cmwpOyB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgICAgIC8vIGNsb3NlIGNvdWxkIGJlIGNhbGxlZCBiZWZvcmUgY3JlYXRpbmcgdGhlIHdzXHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fY2xvc2VDYWxsZWQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLl9jb25uZWN0TG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzLl9kZWJ1ZygnY29ubmVjdCcsIHsgdXJsOiB1cmwsIHByb3RvY29sczogX3RoaXMuX3Byb3RvY29scyB9KTtcclxuICAgICAgICAgICAgX3RoaXMuX3dzID0gX3RoaXMuX3Byb3RvY29sc1xyXG4gICAgICAgICAgICAgICAgPyBuZXcgV2ViU29ja2V0KHVybCwgX3RoaXMuX3Byb3RvY29scylcclxuICAgICAgICAgICAgICAgIDogbmV3IFdlYlNvY2tldCh1cmwpO1xyXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgIF90aGlzLl93cy5iaW5hcnlUeXBlID0gX3RoaXMuX2JpbmFyeVR5cGU7XHJcbiAgICAgICAgICAgIF90aGlzLl9jb25uZWN0TG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBfdGhpcy5fYWRkTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgIF90aGlzLl9jb25uZWN0VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2hhbmRsZVRpbWVvdXQoKTsgfSwgY29ubmVjdGlvblRpbWVvdXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUuX2hhbmRsZVRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVidWcoJ3RpbWVvdXQgZXZlbnQnKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFcnJvcihuZXcgRXJyb3JFdmVudChFcnJvcignVElNRU9VVCcpLCB0aGlzKSk7XHJcbiAgICB9O1xyXG4gICAgUmVjb25uZWN0aW5nV2ViU29ja2V0LnByb3RvdHlwZS5fZGlzY29ubmVjdCA9IGZ1bmN0aW9uIChjb2RlLCByZWFzb24pIHtcclxuICAgICAgICBpZiAoY29kZSA9PT0gdm9pZCAwKSB7IGNvZGUgPSAxMDAwOyB9XHJcbiAgICAgICAgdGhpcy5fY2xlYXJUaW1lb3V0cygpO1xyXG4gICAgICAgIGlmICghdGhpcy5fd3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9yZW1vdmVMaXN0ZW5lcnMoKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0aGlzLl93cy5jbG9zZShjb2RlLCByZWFzb24pO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDbG9zZShuZXcgQ2xvc2VFdmVudChjb2RlLCByZWFzb24sIHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIGlnbm9yZVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWNvbm5lY3RpbmdXZWJTb2NrZXQucHJvdG90eXBlLl9hY2NlcHRPcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX2RlYnVnKCdhY2NlcHQgb3BlbicpO1xyXG4gICAgICAgIHRoaXMuX3JldHJ5Q291bnQgPSAwO1xyXG4gICAgfTtcclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUuX2NhbGxFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBsaXN0ZW5lcikge1xyXG4gICAgICAgIGlmICgnaGFuZGxlRXZlbnQnIGluIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcclxuICAgICAgICAgICAgbGlzdGVuZXIuaGFuZGxlRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICBsaXN0ZW5lcihldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUuX3JlbW92ZUxpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3dzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZGVidWcoJ3JlbW92ZUxpc3RlbmVycycpO1xyXG4gICAgICAgIHRoaXMuX3dzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29wZW4nLCB0aGlzLl9oYW5kbGVPcGVuKTtcclxuICAgICAgICB0aGlzLl93cy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbG9zZScsIHRoaXMuX2hhbmRsZUNsb3NlKTtcclxuICAgICAgICB0aGlzLl93cy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5faGFuZGxlTWVzc2FnZSk7XHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgIHRoaXMuX3dzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gICAgfTtcclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUuX2FkZExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3dzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZGVidWcoJ2FkZExpc3RlbmVycycpO1xyXG4gICAgICAgIHRoaXMuX3dzLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCB0aGlzLl9oYW5kbGVPcGVuKTtcclxuICAgICAgICB0aGlzLl93cy5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIHRoaXMuX2hhbmRsZUNsb3NlKTtcclxuICAgICAgICB0aGlzLl93cy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5faGFuZGxlTWVzc2FnZSk7XHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgIHRoaXMuX3dzLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5faGFuZGxlRXJyb3IpO1xyXG4gICAgfTtcclxuICAgIFJlY29ubmVjdGluZ1dlYlNvY2tldC5wcm90b3R5cGUuX2NsZWFyVGltZW91dHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX2Nvbm5lY3RUaW1lb3V0KTtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdXB0aW1lVGltZW91dCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlY29ubmVjdGluZ1dlYlNvY2tldDtcclxufSgpKTtcblxuZXhwb3J0IGRlZmF1bHQgUmVjb25uZWN0aW5nV2ViU29ja2V0O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==