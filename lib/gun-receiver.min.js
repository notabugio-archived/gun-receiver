!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("ramda"),require("uuid"),require("flat"),require("redis"),require("ws")):"function"==typeof define&&define.amd?define("gun-receiver",["ramda","uuid","flat","redis","ws"],n):"object"==typeof exports?exports["gun-receiver"]=n(require("ramda"),require("uuid"),require("flat"),require("redis"),require("ws")):e["gun-receiver"]=n(e.ramda,e.uuid,e.flat,e.redis,e.ws)}("undefined"!=typeof self?self:this,function(e,n,t,r,o){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(n,t){n.exports=e},function(e,t){e.exports=n},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"chainInterface",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"preventConflicts",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"Receiver",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"deduplicateMessages",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"allowLeech",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"relayMessages",{enumerable:!0,get:function(){return a.default}}),n.websocketTransport=n.redisBackend=void 0;var r=d(t(3)),o=d(t(4)),u=d(t(5)),i=d(t(6)),c=d(t(7)),f=l(t(8)),a=d(t(11)),s=l(t(12));function l(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}function d(e){return e&&e.__esModule?e:{default:e}}var p=f;n.redisBackend=p;var v=s;n.websocketTransport=v},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t(0);function o(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.default=function(e){return e.get=function(n){return function n(t){var u,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=function(n){var o,c,f=!1,a=n.bind(u),s=function(e){return(f=!0)&&a(o=e)},l={},d={},p=e.connected(function(e){var n=e.json;(0,r.keys)((0,r.prop)("put",n)).forEach(function(e){if(l[e]){var t=(0,r.path)(["put",e],n);t||f||s(),t&&(d[e]=t)}});var u=c(t);u!==o&&s(u)}),v=function(e){return l[e]?d[e]:(l[e]=!0,p.receive({...i,json:{get:{"#":e}},skipValidation:!0}),d[e])};return c=function(e){var n=e[e.length-1];if(1===e.length)return v(n);var o=c(e.slice(0,e.length-1));if(o){var u=(0,r.prop)(n,o);return u&&u["#"]?v(u["#"]):(e===t&&s(u),u)}},p.receive({json:{leech:!0}}),c(t),function(){return e.disconnected(p)}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.identity;return new Promise(function(e){var n=c(function(t){e(t),n()})}).then(e)};return u={get:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n([].concat(o(t),[e]),r)},on:c,then:f,once:function(e){return f(e.bind(u))&&u}}}([n],arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},e},e.exports=n.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t(0);n.default=function(e){return e.onIn(function(n){var t=n.json,o=[],u=(0,r.keys)((0,r.prop)("put",t));return u.length?Promise.all(u.map(function(n){var u=(0,r.path)(["put",n,"_",">"],t)||{};return e.get(n,{noRelay:!0}).then(function(e){var n=(0,r.path)(["_",">"],e)||{};(0,r.keys)(u).forEach(function(e){n[e]&&n[e]>u[e]||o.push(u[e])})})})).then(function(){return o.length||t.get?n:null}):Promise.resolve(n)}),e},e.exports=n.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e,n=[],t=i(c(),2),r=t[0],f=t[1],a=i(c(),2),s=a[0],l=a[1];return e={connections:n,connected:function(t){var r=function(e){var n,t=e.db,r=e.send,i={},c=!1;return n={send:function(e){return t.processOut({...e,to:n}).then(function(e){return e&&r(e)}).catch(function(n){c||console.error("PISTOL send err",JSON.stringify(e,null,2),e.json.put,n),c=!0})},receive:function(e){var r=e.json,o=function(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},u=Object.keys(e);for(r=0;r<u.length;r++)t=u[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(r=0;r<u.length;r++)t=u[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(e,["json"]),i=JSON.stringify(r,null,2);return t.processIn({...o,db:t,json:{...r,"#":r["#"]||u.default.v4()},from:n}).catch(function(e){return console.error("PISTOL receive err",e,i)})},get:function(e){return(0,o.path)(e,i)},set:function(e,n){return i=(0,o.assocPath)(e,n,i)}}}({db:e,send:t});return n.push(r),r},disconnected:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1)},onIn:r,onOut:s,processIn:f,processOut:l}};var r,o=t(0),u=(r=t(1))&&r.__esModule?r:{default:r};function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,u=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,u=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw u}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(){var e=[];return[function(n){return e.push(n)},function(n){var t=e.slice().reverse();return function e(n){try{var r=t.pop();return n&&r?Promise.resolve(r(n)).then(e):Promise.resolve(n)}catch(e){return Promise.reject(e)}}(n)},function(n){return e=(0,o.without)([n],e)}]}e.exports=n.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t(0),o=1e4;n.default=function(e){var n={};return e.onIn(function(e){var t=(0,r.path)(["json","#"],e);return!t||t in n?null:(n[t]=!0,function(){for(var e;(e=Object.keys(n)).length>o;)delete n[e[0]]}(),e)}),e},e.exports=n.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t(0);function o(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.default=function(e){return e.onIn(function(e){if(!(0,r.path)(["json","leech"],e))return[(0,r.path)(["json","get","#"],e)].concat(o((0,r.keys)((0,r.path)(["json","put"],e)))).forEach(function(n){return n&&e.from.set(["hasAskedFor",n],!0)}),e;e.from.set(["isLeeching"],!0)}),e.onOut(function(e){var n=e.to,t=e.json,o=e.ignoreLeeching;return!n.get(["isLeeching"])||o?e:(0,r.keys)(t.put).filter(function(e){if(!n.get(["hasAskedFor",e]))return!1;var o=(0,r.path)([e,"_",">"],t.put),u=!1;return!(0,r.keys)(o).length||((0,r.keys)(o).forEach(function(t){var r=n.get(["knownDeltas",e,t])||0,i=parseFloat(o[t])||0;r&&i<=r||(n.set(["knownDeltas",e,t],i),u=!0)}),u)}).length?e:void 0}),e},e.exports=n.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.respondToGets=void 0;var r=t(0);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=t(1),i=t(9),c=1e5,f=function(e){if(!e)return e;var n=e._&&e._[">"]||{};return(0,r.keys)(n).forEach(function(t){var u=n[t];if("object"===o(u)){var i=(0,r.keys)(u),c=i[0];if(c){var f=[t,i].join("."),a=u[c];delete n[t],n[f]=a,a=e[t]&&e[t][c]||null,delete e[t],e[f]=a}}}),(0,r.keys)(e).forEach(function(e){e[0]}),e};n.respondToGets=function(e){var n=t(10).createClient(),o=function(e){return new Promise(function(t,r){return e?n.hgetall(e,function(e,n){if(e)console.error("get error",e),r(e);else{var o=function(e){if(!e)return e;var n={};return Object.keys(e).forEach(function(n){"."===n[0]&&delete e[n],"|NULL|"===e[n]&&(e[n]=null),"|UNDEFINED|"===e[n]&&(e[n]=void 0),/>\./.test(n)&&(e[n]=parseFloat(e[n],10)||e[n]),e[n]&&e[n].length>c&&(e[n]=e[n].slice(0,c),console.log("truncated",n))}),e=f(i.unflatten(e)),Object.keys(e).sort().forEach(function(t){return n[t]=e[t]}),n}(n);t(o)}}):t(null)})};return e.onIn(function(e){var n=e.from,t=e.json,i=(0,r.path)(["get","#"],t),c=(0,r.prop)("#",t);return i?o(i).then(function(t){var r,o,f,a={"#":u.v4(),"@":c,put:(r={},o=i,f=t||void 0,o in r?Object.defineProperty(r,o,{value:f,enumerable:!0,configurable:!0,writable:!0}):r[o]=f,r)};return n.send({json:a,ignoreLeeching:!0,skipValidation:!t}),t&&-1===i.indexOf("@~")?null:e}):e}),e}},function(e,n){e.exports=t},function(e,n){e.exports=r},function(e,n,t){"use strict";var r=t(0);e.exports=function(e){return e.onIn(function(n){var t=n.from,o=n.json;return n.noRelay?n:((0,r.without)([t],e.connections).forEach(function(e){return e.send({from:t,json:o,skipValidation:!0})}),n)}),e}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.server=void 0;var r=t(0),o=(0,r.curry)(function(e,n){var r=e.web,o=e.port;return new(t(13).Server)({port:r?void 0:o,server:r}).on("connection",function(e){var t=!0,r=!1,o=n.connected(function(n){n&&n.json&&t&&e.send(JSON.stringify(n.json),function(e){e&&!r&&(console.warn("ws send err",e),r=!0)})}),u=setInterval(function(){return o.send({json:{ping:!0},skipValidation:!0})},6e4);e.on("message",function e(n){try{var t=JSON.parse(n);Array.isArray(t)?t.forEach(e):o.receive({json:t})}catch(e){console.error("PISTOL invalid ws msg",e)}}),e.on("close",function(){t=!1,clearInterval(u),n.disconnected(o)})}),n});n.server=o},function(e,n){e.exports=o}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ndW4tcmVjZWl2ZXIvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2d1bi1yZWNlaXZlci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9ndW4tcmVjZWl2ZXIvZXh0ZXJuYWwgXCJyYW1kYVwiIiwid2VicGFjazovL2d1bi1yZWNlaXZlci9leHRlcm5hbCBcInV1aWRcIiIsIndlYnBhY2s6Ly9ndW4tcmVjZWl2ZXIvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZ3VuLXJlY2VpdmVyLy4vc3JjL2NoYWluLmpzIiwid2VicGFjazovL2d1bi1yZWNlaXZlci8uL3NyYy9jb25mbGljdHMuanMiLCJ3ZWJwYWNrOi8vZ3VuLXJlY2VpdmVyLy4vc3JjL2NvcmUuanMiLCJ3ZWJwYWNrOi8vZ3VuLXJlY2VpdmVyLy4vc3JjL2RlZHVwLmpzIiwid2VicGFjazovL2d1bi1yZWNlaXZlci8uL3NyYy9sZWVjaC5qcyIsIndlYnBhY2s6Ly9ndW4tcmVjZWl2ZXIvLi9zcmMvcmVkaXMuanMiLCJ3ZWJwYWNrOi8vZ3VuLXJlY2VpdmVyL2V4dGVybmFsIFwiZmxhdFwiIiwid2VicGFjazovL2d1bi1yZWNlaXZlci9leHRlcm5hbCBcInJlZGlzXCIiLCJ3ZWJwYWNrOi8vZ3VuLXJlY2VpdmVyLy4vc3JjL3JlbGF5LmpzIiwid2VicGFjazovL2d1bi1yZWNlaXZlci8uL3NyYy93ZWJzb2NrZXQuanMiLCJ3ZWJwYWNrOi8vZ3VuLXJlY2VpdmVyL2V4dGVybmFsIFwid3NcIiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJyZXF1aXJlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsInRoaXMiLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX185X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xMF9fIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMTNfXyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJfY2hhaW4iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX2NvbmZsaWN0cyIsIl9jb3JlIiwiX2RlZHVwIiwiX2xlZWNoIiwicmVkaXMiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIl9yZWxheSIsIndlYnNvY2tldCIsInJlZGlzQmFja2VuZCIsIndlYnNvY2tldFRyYW5zcG9ydCIsIl9yYW1kYSIsImRiIiwiZ2V0UGF0aCIsImtleUxpc3QiLCJ0aGlzQ2hhaW4iLCJvcHRzIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwib24iLCJmbiIsImdldFZhbHVlIiwiaGFzUmVzcG9uc2UiLCJib3VuZCIsInJlY2VpdmVkIiwidmFsIiwicmVxdWVzdGVkIiwiZ3JhcGgiLCJjb25uZWN0aW9uIiwiY29ubmVjdGVkIiwibXNnIiwianNvbiIsImtleXMiLCJwcm9wIiwiZm9yRWFjaCIsInNvdWwiLCJub2RlIiwicGF0aCIsIm5leHRWYWx1ZSIsImdldE5vZGUiLCJyZWNlaXZlIiwiIyIsInNraXBWYWxpZGF0aW9uIiwia2wiLCJsYXN0S2V5IiwicGFyZW50VmFsdWUiLCJzbGljZSIsImxlZWNoIiwiZGlzY29ubmVjdGVkIiwidGhlbiIsImlkZW50aXR5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJ1bnN1YnNjcmliZSIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheSIsIm9uY2UiLCJvbkluIiwidXBkYXRlZFZlY3RvcnMiLCJwdXRLZXlzIiwiYWxsIiwibWFwIiwicHV0VmVjdG9ycyIsIm5vUmVsYXkiLCJrbm93blZlY3RvcnMiLCJwdXNoIiwicGVlciIsImNvbm5lY3Rpb25zIiwiX3Byb2Nlc3NRdWV1ZTIiLCJfc2xpY2VkVG9BcnJheSIsInByb2Nlc3NRdWV1ZSIsInByb2Nlc3NJbiIsIl9wcm9jZXNzUXVldWU0Iiwib25PdXQiLCJwcm9jZXNzT3V0Iiwic2VuZCIsIl9yZWYiLCJzZW5kRm4iLCJzdGF0ZSIsImhhc1JlcG9ydGVkRXJyb3IiLCJ0byIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsInB1dCIsIl9yZWYyIiwiX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzIiwicHJlc2VydmVkIiwiX3V1aWQiLCJkZWZhdWx0IiwidjQiLCJmcm9tIiwic2V0IiwidiIsImFzc29jUGF0aCIsInBpc3RvbENvbm5lY3Rpb24iLCJjb25uZWN0aW9uSWR4IiwiaW5kZXhPZiIsInNwbGljZSIsImZucyIsInJlbWFpbmluZ0ZucyIsInJldmVyc2UiLCJleGVjdXRlTmV4dCIsInBvcCIsImUiLCJyZWplY3QiLCJ3aXRob3V0IiwiTUFYX01TR19JRF9DQUNIRSIsInJlY2VpdmVkSWRzIiwiaWQiLCJpZHMiLCJjb2xsZWN0R2FyYmFnZSIsImlnbm9yZUxlZWNoaW5nIiwiZmlsdGVyIiwic291bERlbHRhcyIsImhhc1VwZGF0ZXMiLCJrbm93biIsImRlbHRhIiwicGFyc2VGbG9hdCIsInV1aWQiLCJmbGF0dGVuIiwiRklFTERfU0laRV9MSU1JVCIsInVuZnVjayIsIm9iaiIsImFycm93IiwiXyIsIl90eXBlb2YiLCJ2YWxLZXlzIiwicmVtYWluZGVyIiwicmVhbEtleSIsImpvaW4iLCJyZWFsVmFsdWUiLCJjcmVhdGVDbGllbnQiLCJyZWFkRnVsbE5vZGUiLCJoZ2V0YWxsIiwicmVzIiwiZGF0YSIsInNvcnRlZCIsInRlc3QiLCJsb2ciLCJ1bmZsYXR0ZW4iLCJzb3J0IiwiZnJvbVJlZGlzIiwiZGVkdXBJZCIsInJlc3VsdCIsIkAiLCJzZXJ2ZXIiLCJjdXJyeSIsIndlYiIsInBvcnQiLCJ3cyIsImhhc0xvZ2dlZEVyciIsIndhcm4iLCJwaW5nSW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInBpbmciLCJyYXciLCJwYXJzZSIsIkFycmF5IiwiaXNBcnJheSIsImNsZWFySW50ZXJ2YWwiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsaUJBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELEVBQUFHLFFBQUEsU0FBQUEsUUFBQSxRQUFBQSxRQUFBLFFBQUFBLFFBQUEsU0FBQUEsUUFBQSxPQUNBLG1CQUFBQyxlQUFBQyxJQUNBRCxPQUFBLG9EQUFBSixHQUNBLGlCQUFBQyxRQUNBQSxRQUFBLGdCQUFBRCxFQUFBRyxRQUFBLFNBQUFBLFFBQUEsUUFBQUEsUUFBQSxRQUFBQSxRQUFBLFNBQUFBLFFBQUEsT0FFQUosRUFBQSxnQkFBQUMsRUFBQUQsRUFBQSxNQUFBQSxFQUFBLEtBQUFBLEVBQUEsS0FBQUEsRUFBQSxNQUFBQSxFQUFBLElBUkEsQ0FTQyxvQkFBQU8sVUFBQUMsS0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNELG1CQ1RBLElBQUFDLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQWQsUUFHQSxJQUFBQyxFQUFBVyxFQUFBRSxHQUFBLENBQ0FDLEVBQUFELEVBQ0FFLEdBQUEsRUFDQWhCLFFBQUEsSUFVQSxPQU5BaUIsRUFBQUgsR0FBQUksS0FBQWpCLEVBQUFELFFBQUFDLElBQUFELFFBQUFhLEdBR0FaLEVBQUFlLEdBQUEsRUFHQWYsRUFBQUQsUUEwREEsT0FyREFhLEVBQUFNLEVBQUFGLEVBR0FKLEVB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RUFDWnNJLGNBQWNQLEdBQ2RqSixFQUFHcUMsYUFBYXBCLE9BSWZqQiw4QkMzQ1QzRCxFQUFBRCxRQUFBVyIsImZpbGUiOiJndW4tcmVjZWl2ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicmFtZGFcIiksIHJlcXVpcmUoXCJ1dWlkXCIpLCByZXF1aXJlKFwiZmxhdFwiKSwgcmVxdWlyZShcInJlZGlzXCIpLCByZXF1aXJlKFwid3NcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJndW4tcmVjZWl2ZXJcIiwgW1wicmFtZGFcIiwgXCJ1dWlkXCIsIFwiZmxhdFwiLCBcInJlZGlzXCIsIFwid3NcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiZ3VuLXJlY2VpdmVyXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicmFtZGFcIiksIHJlcXVpcmUoXCJ1dWlkXCIpLCByZXF1aXJlKFwiZmxhdFwiKSwgcmVxdWlyZShcInJlZGlzXCIpLCByZXF1aXJlKFwid3NcIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImd1bi1yZWNlaXZlclwiXSA9IGZhY3Rvcnkocm9vdFtcInJhbWRhXCJdLCByb290W1widXVpZFwiXSwgcm9vdFtcImZsYXRcIl0sIHJvb3RbXCJyZWRpc1wiXSwgcm9vdFtcIndzXCJdKTtcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fOV9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xMF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xM19fKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDIpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xX187IiwiZXhwb3J0IHsgZGVmYXVsdCBhcyBjaGFpbkludGVyZmFjZSB9IGZyb20gXCIuL2NoYWluXCI7XG5leHBvcnQgeyBkZWZhdWx0IGFzIHByZXZlbnRDb25mbGljdHMgfSBmcm9tIFwiLi9jb25mbGljdHNcIjtcbmV4cG9ydCB7IGRlZmF1bHQgYXMgUmVjZWl2ZXIgfSBmcm9tIFwiLi9jb3JlXCI7XG5leHBvcnQgeyBkZWZhdWx0IGFzIGRlZHVwbGljYXRlTWVzc2FnZXMgfSBmcm9tIFwiLi9kZWR1cFwiO1xuZXhwb3J0IHsgZGVmYXVsdCBhcyBhbGxvd0xlZWNoIH0gZnJvbSBcIi4vbGVlY2hcIjtcbmltcG9ydCAqIGFzIHJlZGlzIGZyb20gXCIuL3JlZGlzXCI7XG5leHBvcnQgeyBkZWZhdWx0IGFzIHJlbGF5TWVzc2FnZXMgfSBmcm9tIFwiLi9yZWxheVwiO1xuaW1wb3J0ICogYXMgd2Vic29ja2V0IGZyb20gXCIuL3dlYnNvY2tldFwiO1xuXG5leHBvcnQgY29uc3QgcmVkaXNCYWNrZW5kID0gcmVkaXM7XG5leHBvcnQgY29uc3Qgd2Vic29ja2V0VHJhbnNwb3J0ID0gd2Vic29ja2V0O1xuIiwiLyogZ2xvYmFscyBQcm9taXNlICovXG5pbXBvcnQgeyBpZGVudGl0eSwga2V5cywgcHJvcCwgcGF0aCB9IGZyb20gXCJyYW1kYVwiO1xuXG5leHBvcnQgZGVmYXVsdCBkYiA9PiB7XG4gIGNvbnN0IGdldFBhdGggPSAoa2V5TGlzdCwgb3B0cyA9IHt9KSA9PiB7XG4gICAgbGV0IHRoaXNDaGFpbjtcbiAgICBjb25zdCBvbiA9IGZuID0+IHtcbiAgICAgIGxldCB2YWx1ZSwgZ2V0VmFsdWU7XG4gICAgICBsZXQgaGFzUmVzcG9uc2UgPSBmYWxzZTtcbiAgICAgIGNvbnN0IGJvdW5kID0gZm4uYmluZCh0aGlzQ2hhaW4pO1xuICAgICAgY29uc3QgcmVjZWl2ZWQgPSB2YWwgPT4gKGhhc1Jlc3BvbnNlID0gdHJ1ZSkgJiYgYm91bmQoKHZhbHVlID0gdmFsKSk7XG4gICAgICBjb25zdCByZXF1ZXN0ZWQgPSB7fTtcbiAgICAgIGNvbnN0IGdyYXBoID0ge307XG5cbiAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBkYi5jb25uZWN0ZWQobXNnID0+IHtcbiAgICAgICAgY29uc3QgeyBqc29uIH0gPSBtc2c7XG5cbiAgICAgICAga2V5cyhwcm9wKFwicHV0XCIsIGpzb24pKS5mb3JFYWNoKHNvdWwgPT4ge1xuICAgICAgICAgIGlmICghcmVxdWVzdGVkW3NvdWxdKSByZXR1cm47XG4gICAgICAgICAgY29uc3Qgbm9kZSA9IHBhdGgoW1wicHV0XCIsIHNvdWxdLCBqc29uKTtcblxuICAgICAgICAgIGlmICghbm9kZSAmJiAhaGFzUmVzcG9uc2UpIHJlY2VpdmVkKCk7XG4gICAgICAgICAgaWYgKG5vZGUpIGdyYXBoW3NvdWxdID0gbm9kZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG5leHRWYWx1ZSA9IGdldFZhbHVlKGtleUxpc3QpO1xuXG4gICAgICAgIGlmIChuZXh0VmFsdWUgIT09IHZhbHVlKSByZWNlaXZlZChuZXh0VmFsdWUpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGdldE5vZGUgPSBzb3VsID0+IHtcbiAgICAgICAgaWYgKHJlcXVlc3RlZFtzb3VsXSkgcmV0dXJuIGdyYXBoW3NvdWxdO1xuICAgICAgICByZXF1ZXN0ZWRbc291bF0gPSB0cnVlO1xuICAgICAgICBjb25uZWN0aW9uLnJlY2VpdmUoe1xuICAgICAgICAgIC4uLm9wdHMsXG4gICAgICAgICAganNvbjogeyBnZXQ6IHsgXCIjXCI6IHNvdWwgfSB9LFxuICAgICAgICAgIHNraXBWYWxpZGF0aW9uOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZ3JhcGhbc291bF07XG4gICAgICB9O1xuXG4gICAgICBnZXRWYWx1ZSA9IGtsID0+IHtcbiAgICAgICAgY29uc3QgbGFzdEtleSA9IGtsW2tsLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChrbC5sZW5ndGggPT09IDEpIHJldHVybiBnZXROb2RlKGxhc3RLZXkpO1xuICAgICAgICBjb25zdCBwYXJlbnRWYWx1ZSA9IGdldFZhbHVlKGtsLnNsaWNlKDAsIGtsLmxlbmd0aCAtIDEpKTtcblxuICAgICAgICBpZiAoIXBhcmVudFZhbHVlKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHByb3AobGFzdEtleSwgcGFyZW50VmFsdWUpO1xuXG4gICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZVtcIiNcIl0pIHJldHVybiBnZXROb2RlKHZhbHVlW1wiI1wiXSk7XG4gICAgICAgIGlmIChrbCA9PT0ga2V5TGlzdCkgcmVjZWl2ZWQodmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9O1xuXG4gICAgICBjb25uZWN0aW9uLnJlY2VpdmUoeyBqc29uOiB7IGxlZWNoOiB0cnVlIH0gfSk7XG4gICAgICBnZXRWYWx1ZShrZXlMaXN0KTtcbiAgICAgIHJldHVybiAoKSA9PiBkYi5kaXNjb25uZWN0ZWQoY29ubmVjdGlvbik7XG4gICAgfTtcblxuICAgIGNvbnN0IHRoZW4gPSAoZm4gPSBpZGVudGl0eSkgPT5cbiAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IG9uKHZhbCA9PiB7XG4gICAgICAgICAgcmVzb2x2ZSh2YWwpO1xuICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSkudGhlbihmbik7XG5cbiAgICBjb25zdCBvbmNlID0gZm4gPT4gdGhlbihmbi5iaW5kKHRoaXNDaGFpbikpICYmIHRoaXNDaGFpbjtcbiAgICBjb25zdCBnZXQgPSAoa2V5LCBvcHRzID0ge30pID0+IGdldFBhdGgoWy4uLmtleUxpc3QsIGtleV0sIG9wdHMpO1xuXG4gICAgdGhpc0NoYWluID0geyBnZXQsIG9uLCB0aGVuLCBvbmNlIH07XG4gICAgcmV0dXJuIHRoaXNDaGFpbjtcbiAgfTtcblxuICBkYi5nZXQgPSAoa2V5LCBvcHRzID0ge30pID0+IGdldFBhdGgoW2tleV0sIG9wdHMpO1xuICByZXR1cm4gZGI7XG59O1xuIiwiLyogZ2xvYmFscyBQcm9taXNlICovXG5pbXBvcnQgeyBrZXlzLCBwcm9wLCBwYXRoIH0gZnJvbSBcInJhbWRhXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGRiID0+IHtcbiAgZGIub25Jbihtc2cgPT4ge1xuICAgIGNvbnN0IHsganNvbiB9ID0gbXNnO1xuICAgIGNvbnN0IHVwZGF0ZWRWZWN0b3JzID0gW107XG4gICAgY29uc3QgcHV0S2V5cyA9IGtleXMocHJvcChcInB1dFwiLCBqc29uKSk7XG5cbiAgICBpZiAoIXB1dEtleXMubGVuZ3RoKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG1zZyk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFxuICAgICAgcHV0S2V5cy5tYXAoc291bCA9PiB7XG4gICAgICAgIGNvbnN0IHB1dFZlY3RvcnMgPSBwYXRoKFtcInB1dFwiLCBzb3VsLCBcIl9cIiwgXCI+XCJdLCBqc29uKSB8fCB7fTtcblxuICAgICAgICByZXR1cm4gZGIuZ2V0KHNvdWwsIHsgbm9SZWxheTogdHJ1ZSB9KS50aGVuKG5vZGUgPT4ge1xuICAgICAgICAgIGNvbnN0IGtub3duVmVjdG9ycyA9IHBhdGgoW1wiX1wiLCBcIj5cIl0sIG5vZGUpIHx8IHt9O1xuXG4gICAgICAgICAga2V5cyhwdXRWZWN0b3JzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAoa25vd25WZWN0b3JzW2tleV0gJiYga25vd25WZWN0b3JzW2tleV0gPiBwdXRWZWN0b3JzW2tleV0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdXBkYXRlZFZlY3RvcnMucHVzaChwdXRWZWN0b3JzW2tleV0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgKS50aGVuKCgpID0+ICh1cGRhdGVkVmVjdG9ycy5sZW5ndGggfHwganNvbi5nZXQgPyBtc2cgOiBudWxsKSk7XG4gIH0pO1xuICByZXR1cm4gZGI7XG59O1xuIiwiLyogZ2xvYmFscyBQcm9taXNlICovXG5pbXBvcnQgeyBhc3NvY1BhdGgsIHBhdGgsIHdpdGhvdXQgfSBmcm9tIFwicmFtZGFcIjtcbmltcG9ydCB1dWlkIGZyb20gXCJ1dWlkXCI7XG5cbmZ1bmN0aW9uIHByb2Nlc3NRdWV1ZSgpIHtcbiAgbGV0IGZucyA9IFtdO1xuICBjb25zdCBxdWV1ZSA9IGZuID0+IGZucy5wdXNoKGZuKTtcbiAgY29uc3QgZGVxdWV1ZSA9IGZuID0+IChmbnMgPSB3aXRob3V0KFtmbl0sIGZucykpO1xuXG4gIGZ1bmN0aW9uIGV4ZWN1dGUobXNnKSB7XG4gICAgY29uc3QgcmVtYWluaW5nRm5zID0gZm5zLnNsaWNlKCkucmV2ZXJzZSgpO1xuICAgIGNvbnN0IGV4ZWN1dGVOZXh0ID0gbXNnID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGZuID0gcmVtYWluaW5nRm5zLnBvcCgpO1xuXG4gICAgICAgIGlmIChtc2cgJiYgZm4pIHJldHVybiBQcm9taXNlLnJlc29sdmUoZm4obXNnKSkudGhlbihleGVjdXRlTmV4dCk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobXNnKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gZXhlY3V0ZU5leHQobXNnKTtcbiAgfVxuXG4gIHJldHVybiBbcXVldWUsIGV4ZWN1dGUsIGRlcXVldWVdO1xufVxuXG5mdW5jdGlvbiBwaXN0b2xDb25uZWN0aW9uKHsgZGIsIHNlbmQ6IHNlbmRGbiB9KSB7XG4gIGxldCBjb25uZWN0aW9uO1xuICBsZXQgc3RhdGUgPSB7fTtcbiAgbGV0IGhhc1JlcG9ydGVkRXJyb3IgPSBmYWxzZTtcbiAgY29uc3QgZ2V0ID0gcCA9PiBwYXRoKHAsIHN0YXRlKTtcbiAgY29uc3Qgc2V0ID0gKHAsIHYpID0+IChzdGF0ZSA9IGFzc29jUGF0aChwLCB2LCBzdGF0ZSkpOyAvLyAmJiBjb25zb2xlLmxvZyhzdGF0ZSk7XG4gIGNvbnN0IHNlbmQgPSBtc2cgPT5cbiAgICBkYlxuICAgICAgLnByb2Nlc3NPdXQoeyAuLi5tc2csIHRvOiBjb25uZWN0aW9uIH0pXG4gICAgICAudGhlbihyID0+IHIgJiYgc2VuZEZuKHIpKVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGlmICghaGFzUmVwb3J0ZWRFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgICBcIlBJU1RPTCBzZW5kIGVyclwiLFxuICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkobXNnLCBudWxsLCAyKSxcbiAgICAgICAgICAgIG1zZy5qc29uLnB1dCxcbiAgICAgICAgICAgIGVyclxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaGFzUmVwb3J0ZWRFcnJvciA9IHRydWU7XG4gICAgICB9KTtcbiAgY29uc3QgcmVjZWl2ZSA9ICh7IGpzb24sIC4uLm9wdHMgfSkgPT4ge1xuICAgIGNvbnN0IHByZXNlcnZlZCA9IEpTT04uc3RyaW5naWZ5KGpzb24sIG51bGwsIDIpO1xuXG4gICAgcmV0dXJuIGRiXG4gICAgICAucHJvY2Vzc0luKHtcbiAgICAgICAgLi4ub3B0cyxcbiAgICAgICAgZGIsXG4gICAgICAgIGpzb246IHsgLi4uanNvbiwgXCIjXCI6IGpzb25bXCIjXCJdIHx8IHV1aWQudjQoKSB9LFxuICAgICAgICBmcm9tOiBjb25uZWN0aW9uXG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKFwiUElTVE9MIHJlY2VpdmUgZXJyXCIsIGVyciwgcHJlc2VydmVkKSk7XG4gIH07XG5cbiAgY29ubmVjdGlvbiA9IHsgc2VuZCwgcmVjZWl2ZSwgZ2V0LCBzZXQgfTtcbiAgcmV0dXJuIGNvbm5lY3Rpb247XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFJlY2VpdmVyKCkge1xuICBsZXQgcGVlcjtcbiAgY29uc3QgY29ubmVjdGlvbnMgPSBbXTtcbiAgY29uc3QgW29uSW4sIHByb2Nlc3NJbl0gPSBwcm9jZXNzUXVldWUoKTtcbiAgY29uc3QgW29uT3V0LCBwcm9jZXNzT3V0XSA9IHByb2Nlc3NRdWV1ZSgpO1xuXG4gIGZ1bmN0aW9uIGNvbm5lY3RlZChzZW5kKSB7XG4gICAgY29uc3QgY29ubmVjdGlvbiA9IHBpc3RvbENvbm5lY3Rpb24oeyBkYjogcGVlciwgc2VuZCB9KTtcblxuICAgIGNvbm5lY3Rpb25zLnB1c2goY29ubmVjdGlvbik7XG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gIH1cblxuICBmdW5jdGlvbiBkaXNjb25uZWN0ZWQoY29ubmVjdGlvbikge1xuICAgIGNvbnN0IGNvbm5lY3Rpb25JZHggPSBjb25uZWN0aW9ucy5pbmRleE9mKGNvbm5lY3Rpb24pO1xuXG4gICAgaWYgKGNvbm5lY3Rpb25JZHggIT09IC0xKSBjb25uZWN0aW9ucy5zcGxpY2UoY29ubmVjdGlvbklkeCwgMSk7XG4gIH1cblxuICBwZWVyID0ge1xuICAgIGNvbm5lY3Rpb25zLFxuICAgIGNvbm5lY3RlZCxcbiAgICBkaXNjb25uZWN0ZWQsXG4gICAgb25JbixcbiAgICBvbk91dCxcbiAgICBwcm9jZXNzSW4sXG4gICAgcHJvY2Vzc091dFxuICB9O1xuICByZXR1cm4gcGVlcjtcbn1cbiIsImltcG9ydCB7IHBhdGggfSBmcm9tIFwicmFtZGFcIjtcbmNvbnN0IE1BWF9NU0dfSURfQ0FDSEUgPSAxMDAwMDtcblxuZXhwb3J0IGRlZmF1bHQgZGIgPT4ge1xuICBjb25zdCByZWNlaXZlZElkcyA9IHt9O1xuXG4gIGZ1bmN0aW9uIGNvbGxlY3RHYXJiYWdlKCkge1xuICAgIGxldCBpZHM7XG5cbiAgICB3aGlsZSAoKGlkcyA9IE9iamVjdC5rZXlzKHJlY2VpdmVkSWRzKSkubGVuZ3RoID4gTUFYX01TR19JRF9DQUNIRSkge1xuICAgICAgZGVsZXRlIHJlY2VpdmVkSWRzW2lkc1swXV07XG4gICAgfVxuICB9XG5cbiAgZGIub25Jbihtc2cgPT4ge1xuICAgIGNvbnN0IGlkID0gcGF0aChbXCJqc29uXCIsIFwiI1wiXSwgbXNnKTtcblxuICAgIGlmICghaWQgfHwgaWQgaW4gcmVjZWl2ZWRJZHMpIHJldHVybiBudWxsO1xuICAgIHJlY2VpdmVkSWRzW2lkXSA9IHRydWU7XG4gICAgY29sbGVjdEdhcmJhZ2UoKTtcbiAgICByZXR1cm4gbXNnO1xuICB9KTtcblxuICByZXR1cm4gZGI7XG59O1xuIiwiaW1wb3J0IHsgcGF0aCwga2V5cyB9IGZyb20gXCJyYW1kYVwiO1xuXG5leHBvcnQgZGVmYXVsdCBkYiA9PiB7XG4gIGRiLm9uSW4obXNnID0+IHtcbiAgICBpZiAocGF0aChbXCJqc29uXCIsIFwibGVlY2hcIl0sIG1zZykpIHtcbiAgICAgIG1zZy5mcm9tLnNldChbXCJpc0xlZWNoaW5nXCJdLCB0cnVlKTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbnN0IGFza2luZ0ZvciA9IHBhdGgoW1wianNvblwiLCBcImdldFwiLCBcIiNcIl0sIG1zZyk7XG5cbiAgICBbYXNraW5nRm9yLCAuLi5rZXlzKHBhdGgoW1wianNvblwiLCBcInB1dFwiXSwgbXNnKSldLmZvckVhY2goXG4gICAgICBzb3VsID0+IHNvdWwgJiYgbXNnLmZyb20uc2V0KFtcImhhc0Fza2VkRm9yXCIsIHNvdWxdLCB0cnVlKVxuICAgICk7XG4gICAgcmV0dXJuIG1zZztcbiAgfSk7XG5cbiAgZGIub25PdXQobXNnID0+IHtcbiAgICBjb25zdCB7IHRvLCBqc29uLCBpZ25vcmVMZWVjaGluZyB9ID0gbXNnO1xuXG4gICAgaWYgKCF0by5nZXQoW1wiaXNMZWVjaGluZ1wiXSkgfHwgaWdub3JlTGVlY2hpbmcpIHJldHVybiBtc2c7XG4gICAgY29uc3QgYXNrZWRQdXRzID0ga2V5cyhqc29uLnB1dCkuZmlsdGVyKHNvdWwgPT4ge1xuICAgICAgaWYgKCF0by5nZXQoW1wiaGFzQXNrZWRGb3JcIiwgc291bF0pKSByZXR1cm4gZmFsc2U7XG4gICAgICBjb25zdCBzb3VsRGVsdGFzID0gcGF0aChbc291bCwgXCJfXCIsIFwiPlwiXSwganNvbi5wdXQpO1xuICAgICAgbGV0IGhhc1VwZGF0ZXMgPSBmYWxzZTtcblxuICAgICAgaWYgKCFrZXlzKHNvdWxEZWx0YXMpLmxlbmd0aCkgcmV0dXJuIHRydWU7XG5cbiAgICAgIGtleXMoc291bERlbHRhcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBjb25zdCBrbm93biA9IHRvLmdldChbXCJrbm93bkRlbHRhc1wiLCBzb3VsLCBrZXldKSB8fCAwO1xuICAgICAgICBjb25zdCBkZWx0YSA9IHBhcnNlRmxvYXQoc291bERlbHRhc1trZXldKSB8fCAwO1xuXG4gICAgICAgIGlmIChrbm93biAmJiBkZWx0YSA8PSBrbm93bikgcmV0dXJuO1xuICAgICAgICB0by5zZXQoW1wia25vd25EZWx0YXNcIiwgc291bCwga2V5XSwgZGVsdGEpO1xuICAgICAgICBoYXNVcGRhdGVzID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGhhc1VwZGF0ZXM7XG4gICAgfSk7XG5cbiAgICBpZiAoYXNrZWRQdXRzLmxlbmd0aCkgcmV0dXJuIG1zZztcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9KTtcblxuICByZXR1cm4gZGI7XG59O1xuIiwiLyogZ2xvYmFscyBQcm9taXNlICovXG5pbXBvcnQgeyBrZXlzLCBwYXRoLCBwcm9wIH0gZnJvbSBcInJhbWRhXCI7XG5jb25zdCB1dWlkID0gcmVxdWlyZShcInV1aWRcIik7XG5jb25zdCBmbGF0dGVuID0gcmVxdWlyZShcImZsYXRcIik7XG5cbmNvbnN0IEZJRUxEX1NJWkVfTElNSVQgPSAxMDAwMDA7XG5cbmNvbnN0IHVuZnVjayA9IG9iaiA9PiB7XG4gIC8vIFRoaXMgaXMgcHJvYmFibHkgb25seSBuZWNlc3NhcnkgaWYgeW91IGFyZSBzdHVwaWQgbGlrZSBtZSBhbmQgdXNlIHRoZSBkZWZhdWx0IC4gZGVsaW1pdGVyIGZvciBmbGF0dGVuXG4gIGlmICghb2JqKSByZXR1cm4gb2JqO1xuICBsZXQgYXJyb3cgPSAob2JqLl8gJiYgb2JqLl9bXCI+XCJdKSB8fCB7fTtcblxuICBrZXlzKGFycm93KS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgIGxldCB2YWx1ZSA9IGFycm93W2tleV07XG5cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBsZXQgdmFsS2V5cyA9IGtleXModmFsdWUpO1xuICAgICAgbGV0IHJlbWFpbmRlciA9IHZhbEtleXNbMF07XG5cbiAgICAgIGlmIChyZW1haW5kZXIpIHtcbiAgICAgICAgbGV0IHJlYWxLZXkgPSBba2V5LCB2YWxLZXlzXS5qb2luKFwiLlwiKTtcbiAgICAgICAgbGV0IHJlYWxWYWx1ZSA9IHZhbHVlW3JlbWFpbmRlcl07XG5cbiAgICAgICAgZGVsZXRlIGFycm93W2tleV07XG4gICAgICAgIGFycm93W3JlYWxLZXldID0gcmVhbFZhbHVlO1xuICAgICAgICByZWFsVmFsdWUgPSAob2JqW2tleV0gJiYgb2JqW2tleV1bcmVtYWluZGVyXSkgfHwgbnVsbDtcbiAgICAgICAgZGVsZXRlIG9ialtrZXldO1xuICAgICAgICBvYmpbcmVhbEtleV0gPSByZWFsVmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAga2V5cyhvYmopLmZvckVhY2goa2V5ID0+IHtcbiAgICBpZiAoa2V5WzBdID09PSBcIi5cIikgZGVsZXRlIFtrZXldO1xuICB9KTtcbiAgcmV0dXJuIG9iajtcbn07XG5cbmZ1bmN0aW9uIGZyb21SZWRpcyhvYmopIHtcbiAgaWYgKCFvYmopIHJldHVybiBvYmo7XG4gIGNvbnN0IHNvcnRlZCA9IHt9O1xuXG4gIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICBpZiAoa2V5WzBdID09PSBcIi5cIikgZGVsZXRlIG9ialtrZXldO1xuXG4gICAgaWYgKG9ialtrZXldID09PSBcInxOVUxMfFwiKSB7XG4gICAgICBvYmpba2V5XSA9IG51bGw7XG4gICAgfVxuICAgIGlmIChvYmpba2V5XSA9PT0gXCJ8VU5ERUZJTkVEfFwiKSB7XG4gICAgICBvYmpba2V5XSA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBpZiAoLz5cXC4vLnRlc3Qoa2V5KSkge1xuICAgICAgb2JqW2tleV0gPSBwYXJzZUZsb2F0KG9ialtrZXldLCAxMCkgfHwgb2JqW2tleV07XG4gICAgfVxuICAgIGlmIChvYmpba2V5XSAmJiBvYmpba2V5XS5sZW5ndGggPiBGSUVMRF9TSVpFX0xJTUlUKSB7XG4gICAgICBvYmpba2V5XSA9IG9ialtrZXldLnNsaWNlKDAsIEZJRUxEX1NJWkVfTElNSVQpO1xuICAgICAgY29uc29sZS5sb2coXCJ0cnVuY2F0ZWRcIiwga2V5KTtcbiAgICB9XG4gIH0pO1xuXG4gIG9iaiA9IHVuZnVjayhmbGF0dGVuLnVuZmxhdHRlbihvYmopKTtcblxuICBPYmplY3Qua2V5cyhvYmopXG4gICAgLnNvcnQoKVxuICAgIC5mb3JFYWNoKGtleSA9PiAoc29ydGVkW2tleV0gPSBvYmpba2V5XSkpO1xuXG4gIHJldHVybiBzb3J0ZWQ7XG59XG5cbmV4cG9ydCBjb25zdCByZXNwb25kVG9HZXRzID0gZGIgPT4ge1xuICBjb25zdCByZWRpcyA9IHJlcXVpcmUoXCJyZWRpc1wiKS5jcmVhdGVDbGllbnQoKTtcblxuICBjb25zdCByZWFkRnVsbE5vZGUgPSBzb3VsID0+XG4gICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYgKCFzb3VsKSByZXR1cm4gcmVzb2x2ZShudWxsKTtcbiAgICAgIHJldHVybiByZWRpcy5oZ2V0YWxsKHNvdWwsIGZ1bmN0aW9uKGVyciwgcmVzKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZ2V0IGVycm9yXCIsIGVycik7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IGZyb21SZWRpcyhyZXMpO1xuXG4gICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgZGIub25Jbihtc2cgPT4ge1xuICAgIGNvbnN0IHsgZnJvbSwganNvbiB9ID0gbXNnO1xuICAgIGNvbnN0IHNvdWwgPSBwYXRoKFtcImdldFwiLCBcIiNcIl0sIGpzb24pO1xuICAgIGNvbnN0IGRlZHVwSWQgPSBwcm9wKFwiI1wiLCBqc29uKTtcblxuICAgIGlmICghc291bCkgcmV0dXJuIG1zZztcbiAgICByZXR1cm4gcmVhZEZ1bGxOb2RlKHNvdWwpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgIGNvbnN0IGpzb24gPSB7XG4gICAgICAgIFwiI1wiOiB1dWlkLnY0KCksXG4gICAgICAgIFwiQFwiOiBkZWR1cElkLFxuICAgICAgICBwdXQ6IHsgW3NvdWxdOiByZXN1bHQgfHwgdW5kZWZpbmVkIH1cbiAgICAgIH07XG5cbiAgICAgIC8vIFNraXAgdmFsaWRhdGlvbiB0byBhdm9pZCBsb3NpbmcgdW5kZWZpbmVkIHdoZW4gbm8gcmVzdWx0XG4gICAgICBmcm9tLnNlbmQoeyBqc29uLCBpZ25vcmVMZWVjaGluZzogdHJ1ZSwgc2tpcFZhbGlkYXRpb246ICFyZXN1bHQgfSk7XG4gICAgICBpZiAoIXJlc3VsdCkgcmV0dXJuIG1zZzsgLy8gYWxsb3cgbmV4dCBoYW5kbGVyXG4gICAgICAvLyBQYXNzIHRocm91Z2ggb3JhY2xlIHF1ZXJpZXNcbiAgICAgIHJldHVybiBzb3VsLmluZGV4T2YoXCJAflwiKSA9PT0gLTEgPyBudWxsIDogbXNnO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gZGI7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX185X187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xMF9fOyIsImltcG9ydCB7IHdpdGhvdXQgfSBmcm9tIFwicmFtZGFcIjtcbm1vZHVsZS5leHBvcnRzID0gZGIgPT4ge1xuICBkYi5vbkluKG1zZyA9PiB7XG4gICAgY29uc3QgeyBmcm9tLCBqc29uLCBub1JlbGF5IH0gPSBtc2c7XG5cbiAgICBpZiAobm9SZWxheSkgcmV0dXJuIG1zZztcbiAgICB3aXRob3V0KFtmcm9tXSwgZGIuY29ubmVjdGlvbnMpLmZvckVhY2goYyA9PlxuICAgICAgYy5zZW5kKHsgZnJvbSwganNvbiwgc2tpcFZhbGlkYXRpb246IHRydWUgfSlcbiAgICApO1xuICAgIHJldHVybiBtc2c7XG4gIH0pO1xuICByZXR1cm4gZGI7XG59O1xuIiwiaW1wb3J0IHsgY3VycnkgfSBmcm9tIFwicmFtZGFcIjtcbmNvbnN0IFBJTkcgPSA2MDAwMDtcblxuZXhwb3J0IGNvbnN0IHNlcnZlciA9IGN1cnJ5KCh7IHdlYiwgcG9ydCB9LCBkYikgPT4ge1xuICBuZXcgKHJlcXVpcmUoXCJ3c1wiKSkuU2VydmVyKHsgcG9ydDogIXdlYiA/IHBvcnQgOiB1bmRlZmluZWQsIHNlcnZlcjogd2ViIH0pLm9uKFxuICAgIFwiY29ubmVjdGlvblwiLFxuICAgIHdzID0+IHtcbiAgICAgIGxldCBjb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgbGV0IGhhc0xvZ2dlZEVyciA9IGZhbHNlO1xuICAgICAgY29uc3QgY29ubmVjdGlvbiA9IGRiLmNvbm5lY3RlZChtc2cgPT4ge1xuICAgICAgICBpZiAoIW1zZyB8fCAhbXNnLmpzb24gfHwgIWNvbm5lY3RlZCkgcmV0dXJuO1xuICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KG1zZy5qc29uKSwgZXJyID0+IHtcbiAgICAgICAgICBpZiAoIWVyciB8fCBoYXNMb2dnZWRFcnIpIHJldHVybjtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJ3cyBzZW5kIGVyclwiLCBlcnIpO1xuICAgICAgICAgIGhhc0xvZ2dlZEVyciA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHBpbmdJbnRlcnZhbCA9IHNldEludGVydmFsKFxuICAgICAgICAoKSA9PiBjb25uZWN0aW9uLnNlbmQoeyBqc29uOiB7IHBpbmc6IHRydWUgfSwgc2tpcFZhbGlkYXRpb246IHRydWUgfSksXG4gICAgICAgIFBJTkdcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlY2VpdmUgPSByYXcgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKHJhdyk7XG5cbiAgICAgICAgICBBcnJheS5pc0FycmF5KGpzb24pXG4gICAgICAgICAgICA/IGpzb24uZm9yRWFjaChyZWNlaXZlKVxuICAgICAgICAgICAgOiBjb25uZWN0aW9uLnJlY2VpdmUoeyBqc29uIH0pO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIlBJU1RPTCBpbnZhbGlkIHdzIG1zZ1wiLCBlKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgd3Mub24oXCJtZXNzYWdlXCIsIHJlY2VpdmUpO1xuICAgICAgd3Mub24oXCJjbG9zZVwiLCAoKSA9PiB7XG4gICAgICAgIGNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICBjbGVhckludGVydmFsKHBpbmdJbnRlcnZhbCk7XG4gICAgICAgIGRiLmRpc2Nvbm5lY3RlZChjb25uZWN0aW9uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgKTtcbiAgcmV0dXJuIGRiO1xufSk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzEzX187Il0sInNvdXJjZVJvb3QiOiIifQ==